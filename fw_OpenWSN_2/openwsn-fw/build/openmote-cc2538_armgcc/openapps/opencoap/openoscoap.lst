   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 6
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"openoscoap.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.rodata
  16              		.align	2
  19              	rreg_uriquery:
  20 0000 683D7563 		.ascii	"h=ucb\000"
  20      6200
  21 0006 0000     		.align	2
  24              	infoBoardname:
  25 0008 43433235 		.ascii	"CC2538\000"
  25      333800
  26 000f 00       		.align	2
  29              	infouCName:
  30 0010 43433235 		.ascii	"CC2538\000"
  30      333800
  31 0017 00       		.align	2
  34              	infoRadioName:
  35 0018 43433235 		.ascii	"CC2538 SoC\000"
  35      33382053 
  35      6F4300
  36 0023 00       		.align	2
  39              	infoStackName:
  40 0024 4F70656E 		.ascii	"OpenWSN \000"
  40      57534E20 
  40      00
  41 002d 000000   		.align	2
  44              	ipAddr_ipsoRD:
  45 0030 26       		.byte	38
  46 0031 07       		.byte	7
  47 0032 F7       		.byte	-9
  48 0033 40       		.byte	64
  49 0034 00       		.byte	0
  50 0035 00       		.byte	0
  51 0036 00       		.byte	0
  52 0037 3F       		.byte	63
  53 0038 00       		.byte	0
  54 0039 00       		.byte	0
  55 003a 00       		.byte	0
  56 003b 00       		.byte	0
  57 003c 00       		.byte	0
  58 003d 00       		.byte	0
  59 003e 0E       		.byte	14
  60 003f 29       		.byte	41
  61              		.align	2
  64              	ipAddr_motesEecs:
  65 0040 20       		.byte	32
  66 0041 01       		.byte	1
  67 0042 04       		.byte	4
  68 0043 70       		.byte	112
  69 0044 00       		.byte	0
  70 0045 66       		.byte	102
  71 0046 00       		.byte	0
  72 0047 19       		.byte	25
  73 0048 00       		.byte	0
  74 0049 00       		.byte	0
  75 004a 00       		.byte	0
  76 004b 00       		.byte	0
  77 004c 00       		.byte	0
  78 004d 00       		.byte	0
  79 004e 00       		.byte	0
  80 004f 02       		.byte	2
  81              		.align	2
  84              	ipAddr_local:
  85 0050 26       		.byte	38
  86 0051 07       		.byte	7
  87 0052 F1       		.byte	-15
  88 0053 40       		.byte	64
  89 0054 04       		.byte	4
  90 0055 00       		.byte	0
  91 0056 10       		.byte	16
  92 0057 36       		.byte	54
  93 0058 4D       		.byte	77
  94 0059 CD       		.byte	-51
  95 005a AB       		.byte	-85
  96 005b 54       		.byte	84
  97 005c 81       		.byte	-127
  98 005d 99       		.byte	-103
  99 005e C1       		.byte	-63
 100 005f F7       		.byte	-9
 101              		.align	2
 104              	ipAddr_motedata:
 105 0060 20       		.byte	32
 106 0061 01       		.byte	1
 107 0062 04       		.byte	4
 108 0063 70       		.byte	112
 109 0064 00       		.byte	0
 110 0065 66       		.byte	102
 111 0066 00       		.byte	0
 112 0067 17       		.byte	23
 113 0068 00       		.byte	0
 114 0069 00       		.byte	0
 115 006a 00       		.byte	0
 116 006b 00       		.byte	0
 117 006c 00       		.byte	0
 118 006d 00       		.byte	0
 119 006e 00       		.byte	0
 120 006f 02       		.byte	2
 121              		.align	2
 124              	ipAddr_ringmaster:
 125 0070 BB       		.byte	-69
 126 0071 BB       		.byte	-69
 127 0072 00       		.byte	0
 128 0073 00       		.byte	0
 129 0074 00       		.byte	0
 130 0075 00       		.byte	0
 131 0076 00       		.byte	0
 132 0077 00       		.byte	0
 133 0078 00       		.byte	0
 134 0079 00       		.byte	0
 135 007a 00       		.byte	0
 136 007b 00       		.byte	0
 137 007c 00       		.byte	0
 138 007d 00       		.byte	0
 139 007e 00       		.byte	0
 140 007f 01       		.byte	1
 141              		.comm	openoscoap_vars,1,4
 142              		.text
 143              		.align	1
 144              		.global	openoscoap_init_security_context
 145              		.syntax unified
 146              		.thumb
 147              		.thumb_func
 148              		.fpu softvfp
 150              	openoscoap_init_security_context:
 151              	.LFB3:
 152              		.file 1 "build\\openmote-cc2538_armgcc\\openapps\\opencoap\\openoscoap.c"
   1:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** #include "opendefs.h"
   2:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** #include "openserial.h"
   3:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** #include "packetfunctions.h"
   4:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** #include "openoscoap.h"
   5:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** #include "cborencoder.h"
   6:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** #include "cryptoengine.h"
   7:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** #include "sha.h"
   8:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
   9:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  10:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** //=========================== defines =========================================
  11:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  12:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** #define EAAD_MAX_LEN            9 + OSCOAP_MAX_ID_LEN // assumes no Class I options
  13:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** #define AAD_MAX_LEN            12 + EAAD_MAX_LEN
  14:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  15:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** //=========================== variables =======================================
  16:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  17:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** openoscoap_vars_t openoscoap_vars;
  18:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  19:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** //=========================== prototype =======================================
  20:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** owerror_t hkdf_derive_parameter(uint8_t* buffer,
  21:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* masterSecret,
  22:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t masterSecretLen,
  23:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* masterSalt,
  24:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t masterSaltLen,
  25:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* identifier,
  26:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t identifierLen,
  27:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t algorithm,
  28:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         oscoap_derivation_t type,
  29:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t length
  30:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         );
  31:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  32:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** bool is_request(uint8_t code);
  33:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  34:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** uint8_t openoscoap_construct_aad(uint8_t* buffer,
  35:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t version,
  36:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t code,
  37:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* optionsSerialized,
  38:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t optionsSerializedLen,
  39:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t aeadAlgorithm,
  40:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* requestKid,
  41:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t requestKidLen,
  42:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* requestSeq,
  43:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t requestSeqLen
  44:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         );
  45:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  46:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** void openoscoap_encode_compressed_COSE(OpenQueueEntry_t* msg,
  47:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* requestSeq, uint8_t requestSeqLen,
  48:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* requestKid,
  49:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t requestKidLen);
  50:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  51:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** void xor_arrays(uint8_t* s1, uint8_t* s2, uint8_t* dst, uint8_t len);
  52:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  53:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** void flip_first_bit(uint8_t* source, uint8_t* dst, uint8_t len);
  54:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  55:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** bool replay_window_check(oscoap_security_context_t *context, uint16_t sequenceNumber);
  56:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** void replay_window_update(oscoap_security_context_t *context, uint16_t sequenceNumber);
  57:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  58:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** uint8_t openoscoap_convert_sequence_number(uint16_t sequenceNumber, uint8_t** buffer);
  59:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** //=========================== public ==========================================
  60:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  61:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  62:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** /**
  63:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** \brief Initialize OSCOAP security context.
  64:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  65:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** This function will derive the parameters needed to initialize OSCOAP
  66:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** security context.
  67:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  68:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** \param[out] ctx OSCOAP security context structure.
  69:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** \param[in] senderID Pointer to the Byte array containing Sender ID.
  70:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** \param[in] senderIDLen Length of the Sender ID byte array in bytes.
  71:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** \param[in] recipientID Pointer to the Byte array contaning Recipient ID.
  72:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** \param[in] recipientIDLen Length of the Recipient ID byte array in bytes.
  73:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** \param[in] Pointer to the byte array contaning the Master Secret.
  74:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** \param[in] Length of the Master Secret byte array in bytes.
  75:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** \param[in] Pointer to the byte array contaning Master Salt.
  76:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** \param[in] Length of the Master Salt byte array in bytes.
  77:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** */
  78:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  79:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** void openoscoap_init_security_context(oscoap_security_context_t *ctx,
  80:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                 uint8_t* senderID,
  81:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                 uint8_t senderIDLen,
  82:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                 uint8_t* recipientID,
  83:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                 uint8_t recipientIDLen,
  84:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                 uint8_t* masterSecret,
  85:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                 uint8_t masterSecretLen,
  86:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                 uint8_t* masterSalt,
  87:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                 uint8_t masterSaltLen) {
 153              		.loc 1 87 0
 154              		.cfi_startproc
 155              		@ args = 20, pretend = 0, frame = 16
 156              		@ frame_needed = 1, uses_anonymous_args = 0
 157 0000 80B5     		push	{r7, lr}
 158              		.cfi_def_cfa_offset 8
 159              		.cfi_offset 7, -8
 160              		.cfi_offset 14, -4
 161 0002 8AB0     		sub	sp, sp, #40
 162              		.cfi_def_cfa_offset 48
 163 0004 06AF     		add	r7, sp, #24
 164              		.cfi_def_cfa 7, 24
 165 0006 F860     		str	r0, [r7, #12]
 166 0008 B960     		str	r1, [r7, #8]
 167 000a 3B60     		str	r3, [r7]
 168 000c 1346     		mov	r3, r2
 169 000e FB71     		strb	r3, [r7, #7]
  88:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  89:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (senderIDLen > OSCOAP_MAX_ID_LEN ||
 170              		.loc 1 89 0
 171 0010 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 172 0012 0A2B     		cmp	r3, #10
 173 0014 7DD8     		bhi	.L5
 174              		.loc 1 89 0 is_stmt 0 discriminator 1
 175 0016 3B7E     		ldrb	r3, [r7, #24]	@ zero_extendqisi2
 176 0018 0A2B     		cmp	r3, #10
 177 001a 7AD8     		bhi	.L5
  90:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             recipientIDLen > OSCOAP_MAX_ID_LEN) {
  91:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return;
  92:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
  93:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  94:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // common context
  95:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ctx->aeadAlgorithm = AES_CCM_16_64_128;
 178              		.loc 1 95 0 is_stmt 1
 179 001c FB68     		ldr	r3, [r7, #12]
 180 001e 0A22     		movs	r2, #10
 181 0020 1A70     		strb	r2, [r3]
  96:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
  97:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // sender context
  98:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     memcpy(ctx->senderID, senderID, senderIDLen);
 182              		.loc 1 98 0
 183 0022 FB68     		ldr	r3, [r7, #12]
 184 0024 0133     		adds	r3, r3, #1
 185 0026 FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 186 0028 B968     		ldr	r1, [r7, #8]
 187 002a 1846     		mov	r0, r3
 188 002c FFF7FEFF 		bl	memcpy
  99:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ctx->senderIDLen = senderIDLen;
 189              		.loc 1 99 0
 190 0030 FB68     		ldr	r3, [r7, #12]
 191 0032 FA79     		ldrb	r2, [r7, #7]
 192 0034 DA72     		strb	r2, [r3, #11]
 100:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // invoke HKDF to get sender Key
 101:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     hkdf_derive_parameter(ctx->senderKey,
 193              		.loc 1 101 0
 194 0036 FB68     		ldr	r3, [r7, #12]
 195 0038 03F10C00 		add	r0, r3, #12
 196 003c 97F82020 		ldrb	r2, [r7, #32]	@ zero_extendqisi2
 197 0040 1023     		movs	r3, #16
 198 0042 0593     		str	r3, [sp, #20]
 199 0044 0023     		movs	r3, #0
 200 0046 0493     		str	r3, [sp, #16]
 201 0048 0A23     		movs	r3, #10
 202 004a 0393     		str	r3, [sp, #12]
 203 004c FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 204 004e 0293     		str	r3, [sp, #8]
 205 0050 BB68     		ldr	r3, [r7, #8]
 206 0052 0193     		str	r3, [sp, #4]
 207 0054 97F82830 		ldrb	r3, [r7, #40]	@ zero_extendqisi2
 208 0058 0093     		str	r3, [sp]
 209 005a 7B6A     		ldr	r3, [r7, #36]
 210 005c F969     		ldr	r1, [r7, #28]
 211 005e FFF7FEFF 		bl	hkdf_derive_parameter
 102:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSecret,
 103:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSecretLen,
 104:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSalt,
 105:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSaltLen,
 106:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             senderID,
 107:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             senderIDLen,
 108:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 109:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             OSCOAP_DERIVATION_TYPE_KEY,
 110:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             AES_CCM_16_64_128_KEY_LEN);
 111:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // invoke HKDF to get sender IV
 112:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     hkdf_derive_parameter(ctx->senderIV,
 212              		.loc 1 112 0
 213 0062 FB68     		ldr	r3, [r7, #12]
 214 0064 03F11C00 		add	r0, r3, #28
 215 0068 97F82020 		ldrb	r2, [r7, #32]	@ zero_extendqisi2
 216 006c 0D23     		movs	r3, #13
 217 006e 0593     		str	r3, [sp, #20]
 218 0070 0123     		movs	r3, #1
 219 0072 0493     		str	r3, [sp, #16]
 220 0074 0A23     		movs	r3, #10
 221 0076 0393     		str	r3, [sp, #12]
 222 0078 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 223 007a 0293     		str	r3, [sp, #8]
 224 007c BB68     		ldr	r3, [r7, #8]
 225 007e 0193     		str	r3, [sp, #4]
 226 0080 97F82830 		ldrb	r3, [r7, #40]	@ zero_extendqisi2
 227 0084 0093     		str	r3, [sp]
 228 0086 7B6A     		ldr	r3, [r7, #36]
 229 0088 F969     		ldr	r1, [r7, #28]
 230 008a FFF7FEFF 		bl	hkdf_derive_parameter
 113:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSecret,
 114:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSecretLen,
 115:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSalt,
 116:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSaltLen,
 117:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             senderID,
 118:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             senderIDLen,
 119:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 120:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             OSCOAP_DERIVATION_TYPE_IV,
 121:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             AES_CCM_16_64_128_IV_LEN);
 122:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 123:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ctx->sequenceNumber = 0;
 231              		.loc 1 123 0
 232 008e FB68     		ldr	r3, [r7, #12]
 233 0090 0022     		movs	r2, #0
 234 0092 5A85     		strh	r2, [r3, #42]	@ movhi
 124:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 125:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // recipient context
 126:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     memcpy(ctx->recipientID, recipientID, recipientIDLen);
 235              		.loc 1 126 0
 236 0094 FB68     		ldr	r3, [r7, #12]
 237 0096 2C33     		adds	r3, r3, #44
 238 0098 3A7E     		ldrb	r2, [r7, #24]	@ zero_extendqisi2
 239 009a 3968     		ldr	r1, [r7]
 240 009c 1846     		mov	r0, r3
 241 009e FFF7FEFF 		bl	memcpy
 127:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ctx->recipientIDLen = recipientIDLen;
 242              		.loc 1 127 0
 243 00a2 FB68     		ldr	r3, [r7, #12]
 244 00a4 3A7E     		ldrb	r2, [r7, #24]
 245 00a6 83F83620 		strb	r2, [r3, #54]
 128:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // invoke HKDF to get recipient Key
 129:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     hkdf_derive_parameter(ctx->recipientKey,
 246              		.loc 1 129 0
 247 00aa FB68     		ldr	r3, [r7, #12]
 248 00ac 03F13700 		add	r0, r3, #55
 249 00b0 97F82020 		ldrb	r2, [r7, #32]	@ zero_extendqisi2
 250 00b4 1023     		movs	r3, #16
 251 00b6 0593     		str	r3, [sp, #20]
 252 00b8 0023     		movs	r3, #0
 253 00ba 0493     		str	r3, [sp, #16]
 254 00bc 0A23     		movs	r3, #10
 255 00be 0393     		str	r3, [sp, #12]
 256 00c0 3B7E     		ldrb	r3, [r7, #24]	@ zero_extendqisi2
 257 00c2 0293     		str	r3, [sp, #8]
 258 00c4 3B68     		ldr	r3, [r7]
 259 00c6 0193     		str	r3, [sp, #4]
 260 00c8 97F82830 		ldrb	r3, [r7, #40]	@ zero_extendqisi2
 261 00cc 0093     		str	r3, [sp]
 262 00ce 7B6A     		ldr	r3, [r7, #36]
 263 00d0 F969     		ldr	r1, [r7, #28]
 264 00d2 FFF7FEFF 		bl	hkdf_derive_parameter
 130:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSecret,
 131:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSecretLen,
 132:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSalt,
 133:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSaltLen,
 134:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             recipientID,
 135:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             recipientIDLen,
 136:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 137:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             OSCOAP_DERIVATION_TYPE_KEY,
 138:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             AES_CCM_16_64_128_KEY_LEN);
 139:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 140:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // invoke HKDF to get recipient IV
 141:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     hkdf_derive_parameter(ctx->recipientIV,
 265              		.loc 1 141 0
 266 00d6 FB68     		ldr	r3, [r7, #12]
 267 00d8 03F14700 		add	r0, r3, #71
 268 00dc 97F82020 		ldrb	r2, [r7, #32]	@ zero_extendqisi2
 269 00e0 0D23     		movs	r3, #13
 270 00e2 0593     		str	r3, [sp, #20]
 271 00e4 0123     		movs	r3, #1
 272 00e6 0493     		str	r3, [sp, #16]
 273 00e8 0A23     		movs	r3, #10
 274 00ea 0393     		str	r3, [sp, #12]
 275 00ec 3B7E     		ldrb	r3, [r7, #24]	@ zero_extendqisi2
 276 00ee 0293     		str	r3, [sp, #8]
 277 00f0 3B68     		ldr	r3, [r7]
 278 00f2 0193     		str	r3, [sp, #4]
 279 00f4 97F82830 		ldrb	r3, [r7, #40]	@ zero_extendqisi2
 280 00f8 0093     		str	r3, [sp]
 281 00fa 7B6A     		ldr	r3, [r7, #36]
 282 00fc F969     		ldr	r1, [r7, #28]
 283 00fe FFF7FEFF 		bl	hkdf_derive_parameter
 142:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSecret,
 143:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSecretLen,
 144:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSalt,
 145:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             masterSaltLen,
 146:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             recipientID,
 147:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             recipientIDLen,
 148:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 149:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             OSCOAP_DERIVATION_TYPE_IV,
 150:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             AES_CCM_16_64_128_IV_LEN);
 151:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 152:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ctx->window.bitArray = 0x01; // LSB set
 284              		.loc 1 152 0
 285 0102 FB68     		ldr	r3, [r7, #12]
 286 0104 0122     		movs	r2, #1
 287 0106 5A65     		str	r2, [r3, #84]
 153:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ctx->window.rightEdge = 0;
 288              		.loc 1 153 0
 289 0108 FB68     		ldr	r3, [r7, #12]
 290 010a 0022     		movs	r2, #0
 291 010c A3F85820 		strh	r2, [r3, #88]	@ movhi
 292 0110 00E0     		b	.L1
 293              	.L5:
  91:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 294              		.loc 1 91 0
 295 0112 00BF     		nop
 296              	.L1:
 154:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 155:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 297              		.loc 1 155 0
 298 0114 1037     		adds	r7, r7, #16
 299              		.cfi_def_cfa_offset 8
 300 0116 BD46     		mov	sp, r7
 301              		.cfi_def_cfa_register 13
 302              		@ sp needed
 303 0118 80BD     		pop	{r7, pc}
 304              		.cfi_endproc
 305              	.LFE3:
 307              		.align	1
 308              		.global	openoscoap_protect_message
 309              		.syntax unified
 310              		.thumb
 311              		.thumb_func
 312              		.fpu softvfp
 314              	openoscoap_protect_message:
 315              	.LFB4:
 156:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 157:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** owerror_t openoscoap_protect_message(
 158:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         oscoap_security_context_t *context,
 159:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t version,
 160:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t code,
 161:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         coap_option_iht* incomingOptions,
 162:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t incomingOptionsLen,
 163:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         OpenQueueEntry_t* msg,
 164:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint16_t sequenceNumber) {
 316              		.loc 1 164 0
 317              		.cfi_startproc
 318              		@ args = 12, pretend = 0, frame = 120
 319              		@ frame_needed = 1, uses_anonymous_args = 0
 320 011a 90B5     		push	{r4, r7, lr}
 321              		.cfi_def_cfa_offset 12
 322              		.cfi_offset 4, -12
 323              		.cfi_offset 7, -8
 324              		.cfi_offset 14, -4
 325 011c A5B0     		sub	sp, sp, #148
 326              		.cfi_def_cfa_offset 160
 327 011e 06AF     		add	r7, sp, #24
 328              		.cfi_def_cfa 7, 136
 329 0120 F860     		str	r0, [r7, #12]
 330 0122 7B60     		str	r3, [r7, #4]
 331 0124 0B46     		mov	r3, r1
 332 0126 FB72     		strb	r3, [r7, #11]
 333 0128 1346     		mov	r3, r2
 334 012a BB72     		strb	r3, [r7, #10]
 165:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 166:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t* payload;
 167:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t payloadLen;
 168:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t aad[AAD_MAX_LEN];
 169:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t aadLen;
 170:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t nonce[AES_CCM_16_64_128_IV_LEN];
 171:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t partialIV[AES_CCM_16_64_128_IV_LEN];
 172:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t* requestSeq;
 173:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t requestSeqLen;
 174:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t *requestKid;
 175:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t requestKidLen;
 176:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     owerror_t encStatus;
 177:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     coap_option_iht* objectSecurity;
 178:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     bool payloadPresent;
 179:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t                   option_count;
 180:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t                   option_index;
 181:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 182:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // find object security option in the list of passed options
 183:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     option_count = opencoap_find_option(incomingOptions, incomingOptionsLen, COAP_OPTION_NUM_OBJECT
 335              		.loc 1 183 0
 336 012c 07F11703 		add	r3, r7, #23
 337 0130 97F88810 		ldrb	r1, [r7, #136]	@ zero_extendqisi2
 338 0134 1522     		movs	r2, #21
 339 0136 7868     		ldr	r0, [r7, #4]
 340 0138 FFF7FEFF 		bl	opencoap_find_option
 341 013c 0346     		mov	r3, r0
 342 013e 87F86630 		strb	r3, [r7, #102]
 184:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if(option_count >= 1) {
 343              		.loc 1 184 0
 344 0142 97F86630 		ldrb	r3, [r7, #102]	@ zero_extendqisi2
 345 0146 002B     		cmp	r3, #0
 346 0148 05D0     		beq	.L7
 185:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****       objectSecurity = &incomingOptions[option_index];
 347              		.loc 1 185 0
 348 014a FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 349 014c DB00     		lsls	r3, r3, #3
 350 014e 7A68     		ldr	r2, [r7, #4]
 351 0150 1344     		add	r3, r3, r2
 352 0152 BB66     		str	r3, [r7, #104]
 353 0154 01E0     		b	.L8
 354              	.L7:
 186:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     } else {
 187:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****       objectSecurity = NULL;
 355              		.loc 1 187 0
 356 0156 0023     		movs	r3, #0
 357 0158 BB66     		str	r3, [r7, #104]
 358              	.L8:
 188:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 189:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (objectSecurity == NULL) { // objectSecurity option should be set by the application
 359              		.loc 1 189 0
 360 015a BB6E     		ldr	r3, [r7, #104]
 361 015c 002B     		cmp	r3, #0
 362 015e 01D1     		bne	.L9
 190:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return E_FAIL;
 363              		.loc 1 190 0
 364 0160 0123     		movs	r3, #1
 365 0162 0BE1     		b	.L21
 366              	.L9:
 191:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 192:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 193:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // convert sequence number to array and strip leading zeros
 194:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     memset(partialIV, 0x00, AES_CCM_16_64_128_IV_LEN);
 367              		.loc 1 194 0
 368 0164 07F11C03 		add	r3, r7, #28
 369 0168 0D22     		movs	r2, #13
 370 016a 0021     		movs	r1, #0
 371 016c 1846     		mov	r0, r3
 372 016e FFF7FEFF 		bl	memset
 195:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     requestSeq = &partialIV[AES_CCM_16_64_128_IV_LEN - 2];
 373              		.loc 1 195 0
 374 0172 07F11C03 		add	r3, r7, #28
 375 0176 0B33     		adds	r3, r3, #11
 376 0178 BB61     		str	r3, [r7, #24]
 196:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     requestSeqLen = openoscoap_convert_sequence_number(sequenceNumber, &requestSeq);
 377              		.loc 1 196 0
 378 017a 07F11802 		add	r2, r7, #24
 379 017e B7F89030 		ldrh	r3, [r7, #144]
 380 0182 1146     		mov	r1, r2
 381 0184 1846     		mov	r0, r3
 382 0186 FFF7FEFF 		bl	openoscoap_convert_sequence_number
 383 018a 0346     		mov	r3, r0
 384 018c 87F87730 		strb	r3, [r7, #119]
 197:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 198:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (is_request(code)) {
 385              		.loc 1 198 0
 386 0190 BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 387 0192 1846     		mov	r0, r3
 388 0194 FFF7FEFF 		bl	is_request
 389 0198 0346     		mov	r3, r0
 390 019a 002B     		cmp	r3, #0
 391 019c 07D0     		beq	.L11
 199:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestKid = context->senderID;
 392              		.loc 1 199 0
 393 019e FB68     		ldr	r3, [r7, #12]
 394 01a0 0133     		adds	r3, r3, #1
 395 01a2 3B67     		str	r3, [r7, #112]
 200:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestKidLen = context->senderIDLen;
 396              		.loc 1 200 0
 397 01a4 FB68     		ldr	r3, [r7, #12]
 398 01a6 DB7A     		ldrb	r3, [r3, #11]
 399 01a8 87F86F30 		strb	r3, [r7, #111]
 400 01ac 07E0     		b	.L12
 401              	.L11:
 201:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 202:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 203:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestKid = context->recipientID;
 402              		.loc 1 203 0
 403 01ae FB68     		ldr	r3, [r7, #12]
 404 01b0 2C33     		adds	r3, r3, #44
 405 01b2 3B67     		str	r3, [r7, #112]
 204:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestKidLen = context->recipientIDLen;
 406              		.loc 1 204 0
 407 01b4 FB68     		ldr	r3, [r7, #12]
 408 01b6 93F83630 		ldrb	r3, [r3, #54]
 409 01ba 87F86F30 		strb	r3, [r7, #111]
 410              	.L12:
 205:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 206:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 207:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (msg->length > 0 ) { // contains payload, add payload marker
 411              		.loc 1 207 0
 412 01be D7F88C30 		ldr	r3, [r7, #140]
 413 01c2 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 414 01c4 002B     		cmp	r3, #0
 415 01c6 0DD0     		beq	.L13
 208:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         payloadPresent = TRUE;
 416              		.loc 1 208 0
 417 01c8 0123     		movs	r3, #1
 418 01ca 87F86730 		strb	r3, [r7, #103]
 209:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         packetfunctions_reserveHeaderSize(msg,1);
 419              		.loc 1 209 0
 420 01ce 0121     		movs	r1, #1
 421 01d0 D7F88C00 		ldr	r0, [r7, #140]
 422 01d4 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 210:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         msg->payload[0] = COAP_PAYLOAD_MARKER;
 423              		.loc 1 210 0
 424 01d8 D7F88C30 		ldr	r3, [r7, #140]
 425 01dc 5B68     		ldr	r3, [r3, #4]
 426 01de FF22     		movs	r2, #255
 427 01e0 1A70     		strb	r2, [r3]
 428 01e2 02E0     		b	.L14
 429              	.L13:
 211:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 212:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 213:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         payloadPresent = FALSE;
 430              		.loc 1 213 0
 431 01e4 0023     		movs	r3, #0
 432 01e6 87F86730 		strb	r3, [r7, #103]
 433              	.L14:
 214:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 215:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 216:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // encode the options to the openqueue payload buffer
 217:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     opencoap_options_encode(msg,
 434              		.loc 1 217 0
 435 01ea 97F88820 		ldrb	r2, [r7, #136]	@ zero_extendqisi2
 436 01ee 0023     		movs	r3, #0
 437 01f0 7968     		ldr	r1, [r7, #4]
 438 01f2 D7F88C00 		ldr	r0, [r7, #140]
 439 01f6 FFF7FEFF 		bl	opencoap_options_encode
 218:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             incomingOptions,
 219:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             incomingOptionsLen,
 220:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             COAP_OPTION_CLASS_E);
 221:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 222:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     payload = &msg->payload[0];
 440              		.loc 1 222 0
 441 01fa D7F88C30 		ldr	r3, [r7, #140]
 442 01fe 5B68     		ldr	r3, [r3, #4]
 443 0200 3B66     		str	r3, [r7, #96]
 223:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     payloadLen = msg->length;
 444              		.loc 1 223 0
 445 0202 D7F88C30 		ldr	r3, [r7, #140]
 446 0206 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 447 0208 87F85D30 		strb	r3, [r7, #93]
 224:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // shift payload to leave space for authentication tag
 225:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     packetfunctions_reserveHeaderSize(msg, AES_CCM_16_64_128_TAG_LEN);
 448              		.loc 1 225 0
 449 020c 0821     		movs	r1, #8
 450 020e D7F88C00 		ldr	r0, [r7, #140]
 451 0212 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 226:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     memcpy(&msg->payload[0], payload, payloadLen);
 452              		.loc 1 226 0
 453 0216 D7F88C30 		ldr	r3, [r7, #140]
 454 021a 5B68     		ldr	r3, [r3, #4]
 455 021c 97F85D20 		ldrb	r2, [r7, #93]	@ zero_extendqisi2
 456 0220 396E     		ldr	r1, [r7, #96]
 457 0222 1846     		mov	r0, r3
 458 0224 FFF7FEFF 		bl	memcpy
 227:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // update payload pointer but leave length intact
 228:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     payload = &msg->payload[0];
 459              		.loc 1 228 0
 460 0228 D7F88C30 		ldr	r3, [r7, #140]
 461 022c 5B68     		ldr	r3, [r3, #4]
 462 022e 3B66     		str	r3, [r7, #96]
 229:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 230:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     aadLen = openoscoap_construct_aad(aad,
 463              		.loc 1 230 0
 464 0230 BB69     		ldr	r3, [r7, #24]
 465 0232 BC7A     		ldrb	r4, [r7, #10]	@ zero_extendqisi2
 466 0234 F97A     		ldrb	r1, [r7, #11]	@ zero_extendqisi2
 467 0236 07F13C00 		add	r0, r7, #60
 468 023a 97F87720 		ldrb	r2, [r7, #119]	@ zero_extendqisi2
 469 023e 0592     		str	r2, [sp, #20]
 470 0240 0493     		str	r3, [sp, #16]
 471 0242 97F86F30 		ldrb	r3, [r7, #111]	@ zero_extendqisi2
 472 0246 0393     		str	r3, [sp, #12]
 473 0248 3B6F     		ldr	r3, [r7, #112]
 474 024a 0293     		str	r3, [sp, #8]
 475 024c 0A23     		movs	r3, #10
 476 024e 0193     		str	r3, [sp, #4]
 477 0250 0023     		movs	r3, #0
 478 0252 0093     		str	r3, [sp]
 479 0254 0023     		movs	r3, #0
 480 0256 2246     		mov	r2, r4
 481 0258 FFF7FEFF 		bl	openoscoap_construct_aad
 482 025c 0346     		mov	r3, r0
 483 025e 87F85F30 		strb	r3, [r7, #95]
 231:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             version,
 232:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             code,
 233:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             NULL,
 234:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             0, // do not support Class I options at the moment
 235:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 236:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             requestKid,
 237:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             requestKidLen,
 238:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             requestSeq,
 239:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             requestSeqLen);
 240:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 241:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (aadLen > AAD_MAX_LEN) {
 484              		.loc 1 241 0
 485 0262 97F85F30 		ldrb	r3, [r7, #95]	@ zero_extendqisi2
 486 0266 1F2B     		cmp	r3, #31
 487 0268 07D9     		bls	.L15
 242:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         // corruption
 243:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         openserial_printError(
 488              		.loc 1 243 0
 489 026a 0023     		movs	r3, #0
 490 026c 0022     		movs	r2, #0
 491 026e 4721     		movs	r1, #71
 492 0270 2820     		movs	r0, #40
 493 0272 FFF7FEFF 		bl	openserial_printError
 244:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_BUFFER_OVERFLOW,
 245:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0,
 246:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0
 247:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         );
 248:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return E_FAIL;
 494              		.loc 1 248 0
 495 0276 0123     		movs	r3, #1
 496 0278 80E0     		b	.L21
 497              	.L15:
 249:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 250:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 251:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // construct nonce
 252:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (is_request(code)) {
 498              		.loc 1 252 0
 499 027a BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 500 027c 1846     		mov	r0, r3
 501 027e FFF7FEFF 		bl	is_request
 502 0282 0346     		mov	r3, r0
 503 0284 002B     		cmp	r3, #0
 504 0286 0AD0     		beq	.L16
 253:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         xor_arrays(context->senderIV, partialIV, nonce, AES_CCM_16_64_128_IV_LEN);
 505              		.loc 1 253 0
 506 0288 FB68     		ldr	r3, [r7, #12]
 507 028a 03F11C00 		add	r0, r3, #28
 508 028e 07F12C02 		add	r2, r7, #44
 509 0292 07F11C01 		add	r1, r7, #28
 510 0296 0D23     		movs	r3, #13
 511 0298 FFF7FEFF 		bl	xor_arrays
 512 029c 1AE0     		b	.L17
 513              	.L16:
 254:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 255:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 256:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         flip_first_bit(context->senderIV, nonce, AES_CCM_16_64_128_IV_LEN);
 514              		.loc 1 256 0
 515 029e FB68     		ldr	r3, [r7, #12]
 516 02a0 1C33     		adds	r3, r3, #28
 517 02a2 07F12C01 		add	r1, r7, #44
 518 02a6 0D22     		movs	r2, #13
 519 02a8 1846     		mov	r0, r3
 520 02aa FFF7FEFF 		bl	flip_first_bit
 257:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         xor_arrays(nonce, partialIV, nonce, AES_CCM_16_64_128_IV_LEN);
 521              		.loc 1 257 0
 522 02ae 07F12C02 		add	r2, r7, #44
 523 02b2 07F11C01 		add	r1, r7, #28
 524 02b6 07F12C00 		add	r0, r7, #44
 525 02ba 0D23     		movs	r3, #13
 526 02bc FFF7FEFF 		bl	xor_arrays
 258:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         // do not encode sequence number and ID in the response
 259:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestSeq = NULL;
 527              		.loc 1 259 0
 528 02c0 0023     		movs	r3, #0
 529 02c2 BB61     		str	r3, [r7, #24]
 260:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestSeqLen = 0;
 530              		.loc 1 260 0
 531 02c4 0023     		movs	r3, #0
 532 02c6 87F87730 		strb	r3, [r7, #119]
 261:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestKid = NULL;
 533              		.loc 1 261 0
 534 02ca 0023     		movs	r3, #0
 535 02cc 3B67     		str	r3, [r7, #112]
 262:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestKidLen = 0;
 536              		.loc 1 262 0
 537 02ce 0023     		movs	r3, #0
 538 02d0 87F86F30 		strb	r3, [r7, #111]
 539              	.L17:
 263:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 264:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 265:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****      encStatus = cryptoengine_aes_ccms_enc(aad,
 266:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                         aadLen,
 267:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                         payload,
 268:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                         &payloadLen,
 269:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                         nonce,
 270:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                         2, // L=2 in 15.4 std
 271:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                         context->senderKey,
 540              		.loc 1 271 0
 541 02d4 FB68     		ldr	r3, [r7, #12]
 542 02d6 0C33     		adds	r3, r3, #12
 265:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                         aadLen,
 543              		.loc 1 265 0
 544 02d8 07F15D04 		add	r4, r7, #93
 545 02dc 97F85F10 		ldrb	r1, [r7, #95]	@ zero_extendqisi2
 546 02e0 07F13C00 		add	r0, r7, #60
 547 02e4 0822     		movs	r2, #8
 548 02e6 0392     		str	r2, [sp, #12]
 549 02e8 0293     		str	r3, [sp, #8]
 550 02ea 0223     		movs	r3, #2
 551 02ec 0193     		str	r3, [sp, #4]
 552 02ee 07F12C03 		add	r3, r7, #44
 553 02f2 0093     		str	r3, [sp]
 554 02f4 2346     		mov	r3, r4
 555 02f6 3A6E     		ldr	r2, [r7, #96]
 556 02f8 FFF7FEFF 		bl	cryptoengine_aes_ccms_enc
 557 02fc 0346     		mov	r3, r0
 558 02fe 87F85E30 		strb	r3, [r7, #94]
 272:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                         AES_CCM_16_64_128_TAG_LEN);
 273:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 274:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****      if (encStatus != E_SUCCESS) {
 559              		.loc 1 274 0
 560 0302 97F85E30 		ldrb	r3, [r7, #94]	@ zero_extendqisi2
 561 0306 002B     		cmp	r3, #0
 562 0308 01D0     		beq	.L18
 275:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return E_FAIL;
 563              		.loc 1 275 0
 564 030a 0123     		movs	r3, #1
 565 030c 36E0     		b	.L21
 566              	.L18:
 276:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****      }
 277:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 278:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****      // encode compressed COSE
 279:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****      openoscoap_encode_compressed_COSE(msg, requestSeq, requestSeqLen, requestKid, requestKidLen);
 567              		.loc 1 279 0
 568 030e B969     		ldr	r1, [r7, #24]
 569 0310 97F87720 		ldrb	r2, [r7, #119]	@ zero_extendqisi2
 570 0314 97F86F30 		ldrb	r3, [r7, #111]	@ zero_extendqisi2
 571 0318 0093     		str	r3, [sp]
 572 031a 3B6F     		ldr	r3, [r7, #112]
 573 031c D7F88C00 		ldr	r0, [r7, #140]
 574 0320 FFF7FEFF 		bl	openoscoap_encode_compressed_COSE
 280:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 281:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 282:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (payloadPresent) {
 575              		.loc 1 282 0
 576 0324 97F86730 		ldrb	r3, [r7, #103]	@ zero_extendqisi2
 577 0328 002B     		cmp	r3, #0
 578 032a 06D0     		beq	.L19
 283:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         // set the object security option to 0 length
 284:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         // as the value will be carried in message payload
 285:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         objectSecurity->length = 0;
 579              		.loc 1 285 0
 580 032c BB6E     		ldr	r3, [r7, #104]
 581 032e 0022     		movs	r2, #0
 582 0330 5A70     		strb	r2, [r3, #1]
 286:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         objectSecurity->pValue = NULL;
 583              		.loc 1 286 0
 584 0332 BB6E     		ldr	r3, [r7, #104]
 585 0334 0022     		movs	r2, #0
 586 0336 5A60     		str	r2, [r3, #4]
 587 0338 1FE0     		b	.L20
 588              	.L19:
 287:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 288:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 289:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         objectSecurity->length = msg->length;
 589              		.loc 1 289 0
 590 033a D7F88C30 		ldr	r3, [r7, #140]
 591 033e 1A7A     		ldrb	r2, [r3, #8]	@ zero_extendqisi2
 592 0340 BB6E     		ldr	r3, [r7, #104]
 593 0342 5A70     		strb	r2, [r3, #1]
 290:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         // FIXME use the upper bytes in the msg->packet buffer
 291:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         memcpy(&msg->packet[0], &msg->payload[0], msg->length);
 594              		.loc 1 291 0
 595 0344 D7F88C30 		ldr	r3, [r7, #140]
 596 0348 03F1C800 		add	r0, r3, #200
 597 034c D7F88C30 		ldr	r3, [r7, #140]
 598 0350 5968     		ldr	r1, [r3, #4]
 599 0352 D7F88C30 		ldr	r3, [r7, #140]
 600 0356 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 601 0358 1A46     		mov	r2, r3
 602 035a FFF7FEFF 		bl	memcpy
 292:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         objectSecurity->pValue = &msg->packet[0];
 603              		.loc 1 292 0
 604 035e D7F88C30 		ldr	r3, [r7, #140]
 605 0362 03F1C802 		add	r2, r3, #200
 606 0366 BB6E     		ldr	r3, [r7, #104]
 607 0368 5A60     		str	r2, [r3, #4]
 293:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         packetfunctions_tossHeader(msg, msg->length); // reset packet to zero as objectSecurity opt
 608              		.loc 1 293 0
 609 036a D7F88C30 		ldr	r3, [r7, #140]
 610 036e 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 611 0370 1946     		mov	r1, r3
 612 0372 D7F88C00 		ldr	r0, [r7, #140]
 613 0376 FFF7FEFF 		bl	packetfunctions_tossHeader
 614              	.L20:
 294:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 295:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 296:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     return E_SUCCESS;
 615              		.loc 1 296 0
 616 037a 0023     		movs	r3, #0
 617              	.L21:
 297:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 618              		.loc 1 297 0 discriminator 1
 619 037c 1846     		mov	r0, r3
 620 037e 7C37     		adds	r7, r7, #124
 621              		.cfi_def_cfa_offset 12
 622 0380 BD46     		mov	sp, r7
 623              		.cfi_def_cfa_register 13
 624              		@ sp needed
 625 0382 90BD     		pop	{r4, r7, pc}
 626              		.cfi_endproc
 627              	.LFE4:
 629              		.align	1
 630              		.global	openoscoap_unprotect_message
 631              		.syntax unified
 632              		.thumb
 633              		.thumb_func
 634              		.fpu softvfp
 636              	openoscoap_unprotect_message:
 637              	.LFB5:
 298:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 299:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** owerror_t openoscoap_unprotect_message(
 300:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         oscoap_security_context_t *context,
 301:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t version,
 302:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t code,
 303:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         coap_option_iht* incomingOptions,
 304:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* incomingOptionsLen,
 305:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         OpenQueueEntry_t* msg,
 306:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint16_t sequenceNumber) {
 638              		.loc 1 306 0
 639              		.cfi_startproc
 640              		@ args = 12, pretend = 0, frame = 112
 641              		@ frame_needed = 1, uses_anonymous_args = 0
 642 0384 90B5     		push	{r4, r7, lr}
 643              		.cfi_def_cfa_offset 12
 644              		.cfi_offset 4, -12
 645              		.cfi_offset 7, -8
 646              		.cfi_offset 14, -4
 647 0386 A3B0     		sub	sp, sp, #140
 648              		.cfi_def_cfa_offset 152
 649 0388 06AF     		add	r7, sp, #24
 650              		.cfi_def_cfa 7, 128
 651 038a F860     		str	r0, [r7, #12]
 652 038c 7B60     		str	r3, [r7, #4]
 653 038e 0B46     		mov	r3, r1
 654 0390 FB72     		strb	r3, [r7, #11]
 655 0392 1346     		mov	r3, r2
 656 0394 BB72     		strb	r3, [r7, #10]
 307:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 308:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t nonce[AES_CCM_16_64_128_IV_LEN];
 309:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t partialIV[AES_CCM_16_64_128_IV_LEN];
 310:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t *requestKid;
 311:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t requestKidLen;
 312:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t* requestSeq;
 313:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t requestSeqLen;
 314:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t aad[AAD_MAX_LEN];
 315:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t aadLen;
 316:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     coap_option_iht* objectSecurity;
 317:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     owerror_t decStatus;
 318:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t* ciphertext;
 319:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t ciphertextLen;
 320:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     bool payloadInObjSec;
 321:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t index;
 322:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t option_count;
 323:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t option_index;
 324:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 325:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // find object security option in the list of passed options
 326:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     option_count = opencoap_find_option(incomingOptions, *incomingOptionsLen, COAP_OPTION_NUM_OBJEC
 657              		.loc 1 326 0
 658 0396 D7F88030 		ldr	r3, [r7, #128]
 659 039a 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 660 039c 07F11603 		add	r3, r7, #22
 661 03a0 1522     		movs	r2, #21
 662 03a2 7868     		ldr	r0, [r7, #4]
 663 03a4 FFF7FEFF 		bl	opencoap_find_option
 664 03a8 0346     		mov	r3, r0
 665 03aa 87F85E30 		strb	r3, [r7, #94]
 327:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if(option_count >= 1) {
 666              		.loc 1 327 0
 667 03ae 97F85E30 		ldrb	r3, [r7, #94]	@ zero_extendqisi2
 668 03b2 002B     		cmp	r3, #0
 669 03b4 05D0     		beq	.L23
 328:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****       objectSecurity = &incomingOptions[option_index];
 670              		.loc 1 328 0
 671 03b6 BB7D     		ldrb	r3, [r7, #22]	@ zero_extendqisi2
 672 03b8 DB00     		lsls	r3, r3, #3
 673 03ba 7A68     		ldr	r2, [r7, #4]
 674 03bc 1344     		add	r3, r3, r2
 675 03be 7B66     		str	r3, [r7, #100]
 676 03c0 01E0     		b	.L24
 677              	.L23:
 329:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     } else {
 330:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****       objectSecurity = NULL;
 678              		.loc 1 330 0
 679 03c2 0023     		movs	r3, #0
 680 03c4 7B66     		str	r3, [r7, #100]
 681              	.L24:
 331:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 332:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (objectSecurity == NULL) { // return FAIL if object security option is not present
 682              		.loc 1 332 0
 683 03c6 7B6E     		ldr	r3, [r7, #100]
 684 03c8 002B     		cmp	r3, #0
 685 03ca 01D1     		bne	.L25
 333:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return E_FAIL;
 686              		.loc 1 333 0
 687 03cc 0123     		movs	r3, #1
 688 03ce FAE0     		b	.L39
 689              	.L25:
 334:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 335:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 336:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (objectSecurity->length != 0) {
 690              		.loc 1 336 0
 691 03d0 7B6E     		ldr	r3, [r7, #100]
 692 03d2 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 693 03d4 002B     		cmp	r3, #0
 694 03d6 09D0     		beq	.L27
 337:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         ciphertext = objectSecurity->pValue;
 695              		.loc 1 337 0
 696 03d8 7B6E     		ldr	r3, [r7, #100]
 697 03da 5B68     		ldr	r3, [r3, #4]
 698 03dc 3B66     		str	r3, [r7, #96]
 338:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         ciphertextLen = objectSecurity->length;
 699              		.loc 1 338 0
 700 03de 7B6E     		ldr	r3, [r7, #100]
 701 03e0 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 702 03e2 FB75     		strb	r3, [r7, #23]
 339:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         payloadInObjSec = TRUE;
 703              		.loc 1 339 0
 704 03e4 0123     		movs	r3, #1
 705 03e6 87F85F30 		strb	r3, [r7, #95]
 706 03ea 0AE0     		b	.L28
 707              	.L27:
 340:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 341:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 342:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         ciphertext = &msg->payload[0];
 708              		.loc 1 342 0
 709 03ec D7F88430 		ldr	r3, [r7, #132]
 710 03f0 5B68     		ldr	r3, [r3, #4]
 711 03f2 3B66     		str	r3, [r7, #96]
 343:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         ciphertextLen = msg->length;
 712              		.loc 1 343 0
 713 03f4 D7F88430 		ldr	r3, [r7, #132]
 714 03f8 1B7A     		ldrb	r3, [r3, #8]	@ zero_extendqisi2
 715 03fa FB75     		strb	r3, [r7, #23]
 344:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         payloadInObjSec = FALSE;
 716              		.loc 1 344 0
 717 03fc 0023     		movs	r3, #0
 718 03fe 87F85F30 		strb	r3, [r7, #95]
 719              	.L28:
 345:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 346:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 347:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (is_request(code)) {
 720              		.loc 1 347 0
 721 0402 BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 722 0404 1846     		mov	r0, r3
 723 0406 FFF7FEFF 		bl	is_request
 724 040a 0346     		mov	r3, r0
 725 040c 002B     		cmp	r3, #0
 726 040e 1CD0     		beq	.L29
 348:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         if (replay_window_check(context, sequenceNumber) == FALSE) {
 727              		.loc 1 348 0
 728 0410 B7F88830 		ldrh	r3, [r7, #136]
 729 0414 1946     		mov	r1, r3
 730 0416 F868     		ldr	r0, [r7, #12]
 731 0418 FFF7FEFF 		bl	replay_window_check
 732 041c 0346     		mov	r3, r0
 733 041e 83F00103 		eor	r3, r3, #1
 734 0422 DBB2     		uxtb	r3, r3
 735 0424 002B     		cmp	r3, #0
 736 0426 07D0     		beq	.L30
 349:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             openserial_printError(
 737              		.loc 1 349 0
 738 0428 0023     		movs	r3, #0
 739 042a 0022     		movs	r2, #0
 740 042c 4821     		movs	r1, #72
 741 042e 2820     		movs	r0, #40
 742 0430 FFF7FEFF 		bl	openserial_printError
 350:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_REPLAY_FAILED,
 351:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0,
 352:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0
 353:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             );
 354:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             return E_FAIL;
 743              		.loc 1 354 0
 744 0434 0123     		movs	r3, #1
 745 0436 C6E0     		b	.L39
 746              	.L30:
 355:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         }
 356:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestKid = context->recipientID;
 747              		.loc 1 356 0
 748 0438 FB68     		ldr	r3, [r7, #12]
 749 043a 2C33     		adds	r3, r3, #44
 750 043c FB66     		str	r3, [r7, #108]
 357:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestKidLen = context->recipientIDLen;
 751              		.loc 1 357 0
 752 043e FB68     		ldr	r3, [r7, #12]
 753 0440 93F83630 		ldrb	r3, [r3, #54]
 754 0444 87F86B30 		strb	r3, [r7, #107]
 755 0448 06E0     		b	.L31
 756              	.L29:
 358:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 359:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 360:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestKid = context->senderID;
 757              		.loc 1 360 0
 758 044a FB68     		ldr	r3, [r7, #12]
 759 044c 0133     		adds	r3, r3, #1
 760 044e FB66     		str	r3, [r7, #108]
 361:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         requestKidLen = context->senderIDLen;
 761              		.loc 1 361 0
 762 0450 FB68     		ldr	r3, [r7, #12]
 763 0452 DB7A     		ldrb	r3, [r3, #11]
 764 0454 87F86B30 		strb	r3, [r7, #107]
 765              	.L31:
 362:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 363:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 364:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // convert sequence number to array and strip leading zeros
 365:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     memset(partialIV, 0x00, AES_CCM_16_64_128_IV_LEN);
 766              		.loc 1 365 0
 767 0458 07F13C03 		add	r3, r7, #60
 768 045c 0D22     		movs	r2, #13
 769 045e 0021     		movs	r1, #0
 770 0460 1846     		mov	r0, r3
 771 0462 FFF7FEFF 		bl	memset
 366:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     requestSeq = &partialIV[AES_CCM_16_64_128_IV_LEN - 2];
 772              		.loc 1 366 0
 773 0466 07F13C03 		add	r3, r7, #60
 774 046a 0B33     		adds	r3, r3, #11
 775 046c BB63     		str	r3, [r7, #56]
 367:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     requestSeqLen = openoscoap_convert_sequence_number(sequenceNumber, &requestSeq);
 776              		.loc 1 367 0
 777 046e 07F13802 		add	r2, r7, #56
 778 0472 B7F88830 		ldrh	r3, [r7, #136]
 779 0476 1146     		mov	r1, r2
 780 0478 1846     		mov	r0, r3
 781 047a FFF7FEFF 		bl	openoscoap_convert_sequence_number
 782 047e 0346     		mov	r3, r0
 783 0480 87F85D30 		strb	r3, [r7, #93]
 368:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 369:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     aadLen = openoscoap_construct_aad(aad,
 784              		.loc 1 369 0
 785 0484 BB6B     		ldr	r3, [r7, #56]
 786 0486 BC7A     		ldrb	r4, [r7, #10]	@ zero_extendqisi2
 787 0488 F97A     		ldrb	r1, [r7, #11]	@ zero_extendqisi2
 788 048a 07F11800 		add	r0, r7, #24
 789 048e 97F85D20 		ldrb	r2, [r7, #93]	@ zero_extendqisi2
 790 0492 0592     		str	r2, [sp, #20]
 791 0494 0493     		str	r3, [sp, #16]
 792 0496 97F86B30 		ldrb	r3, [r7, #107]	@ zero_extendqisi2
 793 049a 0393     		str	r3, [sp, #12]
 794 049c FB6E     		ldr	r3, [r7, #108]
 795 049e 0293     		str	r3, [sp, #8]
 796 04a0 0A23     		movs	r3, #10
 797 04a2 0193     		str	r3, [sp, #4]
 798 04a4 0023     		movs	r3, #0
 799 04a6 0093     		str	r3, [sp]
 800 04a8 0023     		movs	r3, #0
 801 04aa 2246     		mov	r2, r4
 802 04ac FFF7FEFF 		bl	openoscoap_construct_aad
 803 04b0 0346     		mov	r3, r0
 804 04b2 87F85C30 		strb	r3, [r7, #92]
 370:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             version,
 371:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             code,
 372:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             NULL,
 373:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             0, // do not support Class I options at the moment
 374:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             AES_CCM_16_64_128,
 375:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             requestKid,
 376:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             requestKidLen,
 377:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             requestSeq,
 378:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             requestSeqLen);
 379:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 380:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (aadLen > AAD_MAX_LEN) {
 805              		.loc 1 380 0
 806 04b6 97F85C30 		ldrb	r3, [r7, #92]	@ zero_extendqisi2
 807 04ba 1F2B     		cmp	r3, #31
 808 04bc 07D9     		bls	.L32
 381:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         // corruption
 382:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         openserial_printError(
 809              		.loc 1 382 0
 810 04be 0023     		movs	r3, #0
 811 04c0 0022     		movs	r2, #0
 812 04c2 4721     		movs	r1, #71
 813 04c4 2820     		movs	r0, #40
 814 04c6 FFF7FEFF 		bl	openserial_printError
 383:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_BUFFER_OVERFLOW,
 384:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0,
 385:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0
 386:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         );
 387:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return E_FAIL;
 815              		.loc 1 387 0
 816 04ca 0123     		movs	r3, #1
 817 04cc 7BE0     		b	.L39
 818              	.L32:
 388:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 389:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 390:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // construct nonce
 391:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (is_request(code)) {
 819              		.loc 1 391 0
 820 04ce BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 821 04d0 1846     		mov	r0, r3
 822 04d2 FFF7FEFF 		bl	is_request
 823 04d6 0346     		mov	r3, r0
 824 04d8 002B     		cmp	r3, #0
 825 04da 0AD0     		beq	.L33
 392:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         xor_arrays(context->recipientIV, partialIV, nonce, AES_CCM_16_64_128_IV_LEN);
 826              		.loc 1 392 0
 827 04dc FB68     		ldr	r3, [r7, #12]
 828 04de 03F14700 		add	r0, r3, #71
 829 04e2 07F14C02 		add	r2, r7, #76
 830 04e6 07F13C01 		add	r1, r7, #60
 831 04ea 0D23     		movs	r3, #13
 832 04ec FFF7FEFF 		bl	xor_arrays
 833 04f0 10E0     		b	.L34
 834              	.L33:
 393:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 394:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 395:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         flip_first_bit(context->recipientIV, nonce, AES_CCM_16_64_128_IV_LEN);
 835              		.loc 1 395 0
 836 04f2 FB68     		ldr	r3, [r7, #12]
 837 04f4 4733     		adds	r3, r3, #71
 838 04f6 07F14C01 		add	r1, r7, #76
 839 04fa 0D22     		movs	r2, #13
 840 04fc 1846     		mov	r0, r3
 841 04fe FFF7FEFF 		bl	flip_first_bit
 396:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         xor_arrays(nonce, partialIV, nonce, AES_CCM_16_64_128_IV_LEN);
 842              		.loc 1 396 0
 843 0502 07F14C02 		add	r2, r7, #76
 844 0506 07F13C01 		add	r1, r7, #60
 845 050a 07F14C00 		add	r0, r7, #76
 846 050e 0D23     		movs	r3, #13
 847 0510 FFF7FEFF 		bl	xor_arrays
 848              	.L34:
 397:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 398:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 399:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     decStatus = cryptoengine_aes_ccms_dec(aad,
 400:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                     aadLen,
 401:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                     ciphertext,
 402:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                     &ciphertextLen,
 403:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                     nonce,
 404:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                     2,
 405:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                     context->recipientKey,
 849              		.loc 1 405 0
 850 0514 FB68     		ldr	r3, [r7, #12]
 851 0516 3733     		adds	r3, r3, #55
 399:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                     aadLen,
 852              		.loc 1 399 0
 853 0518 07F11704 		add	r4, r7, #23
 854 051c 97F85C10 		ldrb	r1, [r7, #92]	@ zero_extendqisi2
 855 0520 07F11800 		add	r0, r7, #24
 856 0524 0822     		movs	r2, #8
 857 0526 0392     		str	r2, [sp, #12]
 858 0528 0293     		str	r3, [sp, #8]
 859 052a 0223     		movs	r3, #2
 860 052c 0193     		str	r3, [sp, #4]
 861 052e 07F14C03 		add	r3, r7, #76
 862 0532 0093     		str	r3, [sp]
 863 0534 2346     		mov	r3, r4
 864 0536 3A6E     		ldr	r2, [r7, #96]
 865 0538 FFF7FEFF 		bl	cryptoengine_aes_ccms_dec
 866 053c 0346     		mov	r3, r0
 867 053e 87F85B30 		strb	r3, [r7, #91]
 406:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                                     AES_CCM_16_64_128_TAG_LEN);
 407:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 408:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (decStatus != E_SUCCESS) {
 868              		.loc 1 408 0
 869 0542 97F85B30 		ldrb	r3, [r7, #91]	@ zero_extendqisi2
 870 0546 002B     		cmp	r3, #0
 871 0548 07D0     		beq	.L35
 409:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         openserial_printError(
 872              		.loc 1 409 0
 873 054a 0023     		movs	r3, #0
 874 054c 0022     		movs	r2, #0
 875 054e 4921     		movs	r1, #73
 876 0550 2820     		movs	r0, #40
 877 0552 FFF7FEFF 		bl	openserial_printError
 410:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_DECRYPTION_FAILED,
 411:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0,
 412:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0
 413:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         );
 414:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return E_FAIL;
 878              		.loc 1 414 0
 879 0556 0123     		movs	r3, #1
 880 0558 35E0     		b	.L39
 881              	.L35:
 415:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 416:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 417:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (is_request(code)) {
 882              		.loc 1 417 0
 883 055a BB7A     		ldrb	r3, [r7, #10]	@ zero_extendqisi2
 884 055c 1846     		mov	r0, r3
 885 055e FFF7FEFF 		bl	is_request
 886 0562 0346     		mov	r3, r0
 887 0564 002B     		cmp	r3, #0
 888 0566 05D0     		beq	.L36
 418:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         replay_window_update(context, sequenceNumber);
 889              		.loc 1 418 0
 890 0568 B7F88830 		ldrh	r3, [r7, #136]
 891 056c 1946     		mov	r1, r3
 892 056e F868     		ldr	r0, [r7, #12]
 893 0570 FFF7FEFF 		bl	replay_window_update
 894              	.L36:
 419:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 420:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 421:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (payloadInObjSec) {
 895              		.loc 1 421 0
 896 0574 97F85F30 		ldrb	r3, [r7, #95]	@ zero_extendqisi2
 897 0578 002B     		cmp	r3, #0
 898 057a 09D0     		beq	.L37
 422:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         opencoap_options_parse(objectSecurity->pValue, objectSecurity->length, incomingOptions, inc
 899              		.loc 1 422 0
 900 057c 7B6E     		ldr	r3, [r7, #100]
 901 057e 5868     		ldr	r0, [r3, #4]
 902 0580 7B6E     		ldr	r3, [r7, #100]
 903 0582 5978     		ldrb	r1, [r3, #1]	@ zero_extendqisi2
 904 0584 D7F88030 		ldr	r3, [r7, #128]
 905 0588 7A68     		ldr	r2, [r7, #4]
 906 058a FFF7FEFF 		bl	opencoap_options_parse
 907 058e 19E0     		b	.L38
 908              	.L37:
 423:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 424:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 425:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         packetfunctions_tossFooter(msg, AES_CCM_16_64_128_TAG_LEN);
 909              		.loc 1 425 0
 910 0590 0821     		movs	r1, #8
 911 0592 D7F88400 		ldr	r0, [r7, #132]
 912 0596 FFF7FEFF 		bl	packetfunctions_tossFooter
 426:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         index = opencoap_options_parse(&msg->payload[0], msg->length, incomingOptions, incomingOpti
 913              		.loc 1 426 0
 914 059a D7F88430 		ldr	r3, [r7, #132]
 915 059e 5868     		ldr	r0, [r3, #4]
 916 05a0 D7F88430 		ldr	r3, [r7, #132]
 917 05a4 197A     		ldrb	r1, [r3, #8]	@ zero_extendqisi2
 918 05a6 D7F88030 		ldr	r3, [r7, #128]
 919 05aa 7A68     		ldr	r2, [r7, #4]
 920 05ac FFF7FEFF 		bl	opencoap_options_parse
 921 05b0 0346     		mov	r3, r0
 922 05b2 87F85A30 		strb	r3, [r7, #90]
 427:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         packetfunctions_tossHeader(msg, index);
 923              		.loc 1 427 0
 924 05b6 97F85A30 		ldrb	r3, [r7, #90]	@ zero_extendqisi2
 925 05ba 1946     		mov	r1, r3
 926 05bc D7F88400 		ldr	r0, [r7, #132]
 927 05c0 FFF7FEFF 		bl	packetfunctions_tossHeader
 928              	.L38:
 428:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 429:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 430:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     return E_SUCCESS;
 929              		.loc 1 430 0
 930 05c4 0023     		movs	r3, #0
 931              	.L39:
 431:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 932              		.loc 1 431 0 discriminator 1
 933 05c6 1846     		mov	r0, r3
 934 05c8 7437     		adds	r7, r7, #116
 935              		.cfi_def_cfa_offset 12
 936 05ca BD46     		mov	sp, r7
 937              		.cfi_def_cfa_register 13
 938              		@ sp needed
 939 05cc 90BD     		pop	{r4, r7, pc}
 940              		.cfi_endproc
 941              	.LFE5:
 943              		.align	1
 944              		.global	openoscoap_get_sequence_number
 945              		.syntax unified
 946              		.thumb
 947              		.thumb_func
 948              		.fpu softvfp
 950              	openoscoap_get_sequence_number:
 951              	.LFB6:
 432:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 433:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** uint16_t openoscoap_get_sequence_number(oscoap_security_context_t *context) {
 952              		.loc 1 433 0
 953              		.cfi_startproc
 954              		@ args = 0, pretend = 0, frame = 8
 955              		@ frame_needed = 1, uses_anonymous_args = 0
 956 05ce 80B5     		push	{r7, lr}
 957              		.cfi_def_cfa_offset 8
 958              		.cfi_offset 7, -8
 959              		.cfi_offset 14, -4
 960 05d0 82B0     		sub	sp, sp, #8
 961              		.cfi_def_cfa_offset 16
 962 05d2 00AF     		add	r7, sp, #0
 963              		.cfi_def_cfa_register 7
 964 05d4 7860     		str	r0, [r7, #4]
 434:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (context->sequenceNumber == 0xffff) {
 965              		.loc 1 434 0
 966 05d6 7B68     		ldr	r3, [r7, #4]
 967 05d8 5B8D     		ldrh	r3, [r3, #42]
 968 05da 4FF6FF72 		movw	r2, #65535
 969 05de 9342     		cmp	r3, r2
 970 05e0 06D1     		bne	.L41
 435:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         openserial_printError(
 971              		.loc 1 435 0
 972 05e2 0023     		movs	r3, #0
 973 05e4 0022     		movs	r2, #0
 974 05e6 4621     		movs	r1, #70
 975 05e8 2820     		movs	r0, #40
 976 05ea FFF7FEFF 		bl	openserial_printError
 977 05ee 05E0     		b	.L42
 978              	.L41:
 436:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_SEQUENCE_NUMBER_OVERFLOW,
 437:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0,
 438:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0
 439:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****       );
 440:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     } else {
 441:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         context->sequenceNumber++;
 979              		.loc 1 441 0
 980 05f0 7B68     		ldr	r3, [r7, #4]
 981 05f2 5B8D     		ldrh	r3, [r3, #42]
 982 05f4 0133     		adds	r3, r3, #1
 983 05f6 9AB2     		uxth	r2, r3
 984 05f8 7B68     		ldr	r3, [r7, #4]
 985 05fa 5A85     		strh	r2, [r3, #42]	@ movhi
 986              	.L42:
 442:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 443:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     return context->sequenceNumber;
 987              		.loc 1 443 0
 988 05fc 7B68     		ldr	r3, [r7, #4]
 989 05fe 5B8D     		ldrh	r3, [r3, #42]
 444:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 990              		.loc 1 444 0
 991 0600 1846     		mov	r0, r3
 992 0602 0837     		adds	r7, r7, #8
 993              		.cfi_def_cfa_offset 8
 994 0604 BD46     		mov	sp, r7
 995              		.cfi_def_cfa_register 13
 996              		@ sp needed
 997 0606 80BD     		pop	{r7, pc}
 998              		.cfi_endproc
 999              	.LFE6:
 1001              		.align	1
 1002              		.global	openoscoap_parse_compressed_COSE
 1003              		.syntax unified
 1004              		.thumb
 1005              		.thumb_func
 1006              		.fpu softvfp
 1008              	openoscoap_parse_compressed_COSE:
 1009              	.LFB7:
 445:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 446:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** uint8_t openoscoap_parse_compressed_COSE(uint8_t *buffer,
 447:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t bufferLen,
 448:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint16_t* sequenceNumber,
 449:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t** kid,
 450:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* kidLen
 451:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         ) {
 1010              		.loc 1 451 0
 1011              		.cfi_startproc
 1012              		@ args = 4, pretend = 0, frame = 24
 1013              		@ frame_needed = 1, uses_anonymous_args = 0
 1014 0608 80B5     		push	{r7, lr}
 1015              		.cfi_def_cfa_offset 8
 1016              		.cfi_offset 7, -8
 1017              		.cfi_offset 14, -4
 1018 060a 86B0     		sub	sp, sp, #24
 1019              		.cfi_def_cfa_offset 32
 1020 060c 00AF     		add	r7, sp, #0
 1021              		.cfi_def_cfa_register 7
 1022 060e F860     		str	r0, [r7, #12]
 1023 0610 7A60     		str	r2, [r7, #4]
 1024 0612 3B60     		str	r3, [r7]
 1025 0614 0B46     		mov	r3, r1
 1026 0616 FB72     		strb	r3, [r7, #11]
 452:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t index;
 453:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t pivsz;
 454:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t k;
 455:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t reserved;
 456:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 457:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     index = 0;
 1027              		.loc 1 457 0
 1028 0618 0023     		movs	r3, #0
 1029 061a FB75     		strb	r3, [r7, #23]
 458:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     pivsz = (buffer[index] >> 0) & 0x07;
 1030              		.loc 1 458 0
 1031 061c FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1032 061e FA68     		ldr	r2, [r7, #12]
 1033 0620 1344     		add	r3, r3, r2
 1034 0622 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1035 0624 03F00703 		and	r3, r3, #7
 1036 0628 BB75     		strb	r3, [r7, #22]
 459:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     k = (buffer[index] >> 3) & 0x01;
 1037              		.loc 1 459 0
 1038 062a FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1039 062c FA68     		ldr	r2, [r7, #12]
 1040 062e 1344     		add	r3, r3, r2
 1041 0630 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1042 0632 DB08     		lsrs	r3, r3, #3
 1043 0634 DBB2     		uxtb	r3, r3
 1044 0636 03F00103 		and	r3, r3, #1
 1045 063a 7B75     		strb	r3, [r7, #21]
 460:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     reserved = (buffer[index] >> 4) & 0x0f;
 1046              		.loc 1 460 0
 1047 063c FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1048 063e FA68     		ldr	r2, [r7, #12]
 1049 0640 1344     		add	r3, r3, r2
 1050 0642 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1051 0644 1B09     		lsrs	r3, r3, #4
 1052 0646 3B75     		strb	r3, [r7, #20]
 461:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 462:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (reserved) {
 1053              		.loc 1 462 0
 1054 0648 3B7D     		ldrb	r3, [r7, #20]	@ zero_extendqisi2
 1055 064a 002B     		cmp	r3, #0
 1056 064c 01D0     		beq	.L45
 463:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return 0;
 1057              		.loc 1 463 0
 1058 064e 0023     		movs	r3, #0
 1059 0650 42E0     		b	.L46
 1060              	.L45:
 464:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 465:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 466:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     index++;
 1061              		.loc 1 466 0
 1062 0652 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1063 0654 0133     		adds	r3, r3, #1
 1064 0656 FB75     		strb	r3, [r7, #23]
 467:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 468:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (pivsz > 2) {
 1065              		.loc 1 468 0
 1066 0658 BB7D     		ldrb	r3, [r7, #22]	@ zero_extendqisi2
 1067 065a 022B     		cmp	r3, #2
 1068 065c 01D9     		bls	.L47
 469:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return 0;
 1069              		.loc 1 469 0
 1070 065e 0023     		movs	r3, #0
 1071 0660 3AE0     		b	.L46
 1072              	.L47:
 470:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 471:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else if (pivsz == 1) {
 1073              		.loc 1 471 0
 1074 0662 BB7D     		ldrb	r3, [r7, #22]	@ zero_extendqisi2
 1075 0664 012B     		cmp	r3, #1
 1076 0666 0AD1     		bne	.L48
 472:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         *sequenceNumber = buffer[index];
 1077              		.loc 1 472 0
 1078 0668 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1079 066a FA68     		ldr	r2, [r7, #12]
 1080 066c 1344     		add	r3, r3, r2
 1081 066e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1082 0670 9AB2     		uxth	r2, r3
 1083 0672 7B68     		ldr	r3, [r7, #4]
 1084 0674 1A80     		strh	r2, [r3]	@ movhi
 473:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         index++;
 1085              		.loc 1 473 0
 1086 0676 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1087 0678 0133     		adds	r3, r3, #1
 1088 067a FB75     		strb	r3, [r7, #23]
 1089 067c 0FE0     		b	.L49
 1090              	.L48:
 474:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 475:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else if (pivsz == 2) {
 1091              		.loc 1 475 0
 1092 067e BB7D     		ldrb	r3, [r7, #22]	@ zero_extendqisi2
 1093 0680 022B     		cmp	r3, #2
 1094 0682 0CD1     		bne	.L49
 476:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         *sequenceNumber = packetfunctions_ntohs(&buffer[index]);
 1095              		.loc 1 476 0
 1096 0684 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1097 0686 FA68     		ldr	r2, [r7, #12]
 1098 0688 1344     		add	r3, r3, r2
 1099 068a 1846     		mov	r0, r3
 1100 068c FFF7FEFF 		bl	packetfunctions_ntohs
 1101 0690 0346     		mov	r3, r0
 1102 0692 1A46     		mov	r2, r3
 1103 0694 7B68     		ldr	r3, [r7, #4]
 1104 0696 1A80     		strh	r2, [r3]	@ movhi
 477:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         index += 2;
 1105              		.loc 1 477 0
 1106 0698 FB7D     		ldrb	r3, [r7, #23]
 1107 069a 0233     		adds	r3, r3, #2
 1108 069c FB75     		strb	r3, [r7, #23]
 1109              	.L49:
 478:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 479:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 480:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (k) {
 1110              		.loc 1 480 0
 1111 069e 7B7D     		ldrb	r3, [r7, #21]	@ zero_extendqisi2
 1112 06a0 002B     		cmp	r3, #0
 1113 06a2 12D0     		beq	.L50
 481:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         *kidLen = buffer[index];
 1114              		.loc 1 481 0
 1115 06a4 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1116 06a6 FA68     		ldr	r2, [r7, #12]
 1117 06a8 1344     		add	r3, r3, r2
 1118 06aa 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1119 06ac 3B6A     		ldr	r3, [r7, #32]
 1120 06ae 1A70     		strb	r2, [r3]
 482:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         index++;
 1121              		.loc 1 482 0
 1122 06b0 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1123 06b2 0133     		adds	r3, r3, #1
 1124 06b4 FB75     		strb	r3, [r7, #23]
 483:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         *kid = &buffer[index];
 1125              		.loc 1 483 0
 1126 06b6 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1127 06b8 FA68     		ldr	r2, [r7, #12]
 1128 06ba 1A44     		add	r2, r2, r3
 1129 06bc 3B68     		ldr	r3, [r7]
 1130 06be 1A60     		str	r2, [r3]
 484:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         index += *kidLen;
 1131              		.loc 1 484 0
 1132 06c0 3B6A     		ldr	r3, [r7, #32]
 1133 06c2 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1134 06c4 FB7D     		ldrb	r3, [r7, #23]
 1135 06c6 1344     		add	r3, r3, r2
 1136 06c8 FB75     		strb	r3, [r7, #23]
 1137              	.L50:
 485:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 486:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 487:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (index > bufferLen) {
 1138              		.loc 1 487 0
 1139 06ca FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 1140 06cc FB7A     		ldrb	r3, [r7, #11]	@ zero_extendqisi2
 1141 06ce 9A42     		cmp	r2, r3
 1142 06d0 01D9     		bls	.L51
 488:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return 0;
 1143              		.loc 1 488 0
 1144 06d2 0023     		movs	r3, #0
 1145 06d4 00E0     		b	.L46
 1146              	.L51:
 489:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 490:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 491:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     return index;
 1147              		.loc 1 491 0
 1148 06d6 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1149              	.L46:
 492:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 1150              		.loc 1 492 0
 1151 06d8 1846     		mov	r0, r3
 1152 06da 1837     		adds	r7, r7, #24
 1153              		.cfi_def_cfa_offset 8
 1154 06dc BD46     		mov	sp, r7
 1155              		.cfi_def_cfa_register 13
 1156              		@ sp needed
 1157 06de 80BD     		pop	{r7, pc}
 1158              		.cfi_endproc
 1159              	.LFE7:
 1161              		.section	.rodata
 1162              		.align	2
 1163              	.LC0:
 1164 0080 495600   		.ascii	"IV\000"
 1165              		.text
 1166              		.align	1
 1167              		.global	hkdf_derive_parameter
 1168              		.syntax unified
 1169              		.thumb
 1170              		.thumb_func
 1171              		.fpu softvfp
 1173              	hkdf_derive_parameter:
 1174              	.LFB8:
 493:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 494:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 495:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** //=========================== private =========================================
 496:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 497:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** owerror_t hkdf_derive_parameter(uint8_t* buffer,
 498:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* masterSecret,
 499:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t masterSecretLen,
 500:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* masterSalt,
 501:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t masterSaltLen,
 502:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* identifier,
 503:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t identifierLen,
 504:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t algorithm,
 505:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         oscoap_derivation_t type,
 506:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t length
 507:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         ){
 1175              		.loc 1 507 0
 1176              		.cfi_startproc
 1177              		@ args = 24, pretend = 0, frame = 48
 1178              		@ frame_needed = 1, uses_anonymous_args = 0
 1179 06e0 80B5     		push	{r7, lr}
 1180              		.cfi_def_cfa_offset 8
 1181              		.cfi_offset 7, -8
 1182              		.cfi_offset 14, -4
 1183 06e2 92B0     		sub	sp, sp, #72
 1184              		.cfi_def_cfa_offset 80
 1185 06e4 06AF     		add	r7, sp, #24
 1186              		.cfi_def_cfa 7, 56
 1187 06e6 F860     		str	r0, [r7, #12]
 1188 06e8 B960     		str	r1, [r7, #8]
 1189 06ea 3B60     		str	r3, [r7]
 1190 06ec 1346     		mov	r3, r2
 1191 06ee FB71     		strb	r3, [r7, #7]
 508:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 509:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     const uint8_t iv[] = "IV";
 1192              		.loc 1 509 0
 1193 06f0 534A     		ldr	r2, .L59
 1194 06f2 07F12803 		add	r3, r7, #40
 1195 06f6 1268     		ldr	r2, [r2]
 1196 06f8 1146     		mov	r1, r2	@ movhi
 1197 06fa 1980     		strh	r1, [r3]	@ movhi
 1198 06fc 0233     		adds	r3, r3, #2
 1199 06fe 120C     		lsrs	r2, r2, #16
 1200 0700 1A70     		strb	r2, [r3]
 510:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     const uint8_t key[] = "Key";
 1201              		.loc 1 510 0
 1202 0702 504B     		ldr	r3, .L59+4
 1203 0704 7B62     		str	r3, [r7, #36]
 511:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t info[20];
 512:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t infoLen;
 513:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t ret;
 514:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 515:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     infoLen = 0;
 1204              		.loc 1 515 0
 1205 0706 0023     		movs	r3, #0
 1206 0708 87F82F30 		strb	r3, [r7, #47]
 516:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     infoLen += cborencoder_put_array(&info[infoLen], 4);
 1207              		.loc 1 516 0
 1208 070c 97F82F30 		ldrb	r3, [r7, #47]	@ zero_extendqisi2
 1209 0710 07F11002 		add	r2, r7, #16
 1210 0714 1344     		add	r3, r3, r2
 1211 0716 0421     		movs	r1, #4
 1212 0718 1846     		mov	r0, r3
 1213 071a FFF7FEFF 		bl	cborencoder_put_array
 1214 071e 0346     		mov	r3, r0
 1215 0720 1A46     		mov	r2, r3
 1216 0722 97F82F30 		ldrb	r3, [r7, #47]
 1217 0726 1344     		add	r3, r3, r2
 1218 0728 87F82F30 		strb	r3, [r7, #47]
 517:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     infoLen += cborencoder_put_bytes(&info[infoLen], identifier, identifierLen);
 1219              		.loc 1 517 0
 1220 072c 97F82F30 		ldrb	r3, [r7, #47]	@ zero_extendqisi2
 1221 0730 07F11002 		add	r2, r7, #16
 1222 0734 1344     		add	r3, r3, r2
 1223 0736 97F84020 		ldrb	r2, [r7, #64]	@ zero_extendqisi2
 1224 073a F96B     		ldr	r1, [r7, #60]
 1225 073c 1846     		mov	r0, r3
 1226 073e FFF7FEFF 		bl	cborencoder_put_bytes
 1227 0742 0346     		mov	r3, r0
 1228 0744 1A46     		mov	r2, r3
 1229 0746 97F82F30 		ldrb	r3, [r7, #47]
 1230 074a 1344     		add	r3, r3, r2
 1231 074c 87F82F30 		strb	r3, [r7, #47]
 518:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     infoLen += cborencoder_put_unsigned(&info[infoLen], algorithm);
 1232              		.loc 1 518 0
 1233 0750 97F82F30 		ldrb	r3, [r7, #47]	@ zero_extendqisi2
 1234 0754 07F11002 		add	r2, r7, #16
 1235 0758 1344     		add	r3, r3, r2
 1236 075a 97F84420 		ldrb	r2, [r7, #68]	@ zero_extendqisi2
 1237 075e 1146     		mov	r1, r2
 1238 0760 1846     		mov	r0, r3
 1239 0762 FFF7FEFF 		bl	cborencoder_put_unsigned
 1240 0766 0346     		mov	r3, r0
 1241 0768 1A46     		mov	r2, r3
 1242 076a 97F82F30 		ldrb	r3, [r7, #47]
 1243 076e 1344     		add	r3, r3, r2
 1244 0770 87F82F30 		strb	r3, [r7, #47]
 519:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 520:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (type == OSCOAP_DERIVATION_TYPE_KEY) {
 1245              		.loc 1 520 0
 1246 0774 97F84830 		ldrb	r3, [r7, #72]	@ zero_extendqisi2
 1247 0778 002B     		cmp	r3, #0
 1248 077a 12D1     		bne	.L53
 521:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         infoLen += cborencoder_put_text(&info[infoLen], (char *) key, sizeof(key)-1);
 1249              		.loc 1 521 0
 1250 077c 97F82F30 		ldrb	r3, [r7, #47]	@ zero_extendqisi2
 1251 0780 07F11002 		add	r2, r7, #16
 1252 0784 1344     		add	r3, r3, r2
 1253 0786 07F12401 		add	r1, r7, #36
 1254 078a 0322     		movs	r2, #3
 1255 078c 1846     		mov	r0, r3
 1256 078e FFF7FEFF 		bl	cborencoder_put_text
 1257 0792 0346     		mov	r3, r0
 1258 0794 1A46     		mov	r2, r3
 1259 0796 97F82F30 		ldrb	r3, [r7, #47]
 1260 079a 1344     		add	r3, r3, r2
 1261 079c 87F82F30 		strb	r3, [r7, #47]
 1262 07a0 18E0     		b	.L54
 1263              	.L53:
 522:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 523:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else if (type == OSCOAP_DERIVATION_TYPE_IV) {
 1264              		.loc 1 523 0
 1265 07a2 97F84830 		ldrb	r3, [r7, #72]	@ zero_extendqisi2
 1266 07a6 012B     		cmp	r3, #1
 1267 07a8 12D1     		bne	.L55
 524:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         infoLen += cborencoder_put_text(&info[infoLen], (char *) iv, sizeof(iv)-1);
 1268              		.loc 1 524 0
 1269 07aa 97F82F30 		ldrb	r3, [r7, #47]	@ zero_extendqisi2
 1270 07ae 07F11002 		add	r2, r7, #16
 1271 07b2 1344     		add	r3, r3, r2
 1272 07b4 07F12801 		add	r1, r7, #40
 1273 07b8 0222     		movs	r2, #2
 1274 07ba 1846     		mov	r0, r3
 1275 07bc FFF7FEFF 		bl	cborencoder_put_text
 1276 07c0 0346     		mov	r3, r0
 1277 07c2 1A46     		mov	r2, r3
 1278 07c4 97F82F30 		ldrb	r3, [r7, #47]
 1279 07c8 1344     		add	r3, r3, r2
 1280 07ca 87F82F30 		strb	r3, [r7, #47]
 1281 07ce 01E0     		b	.L54
 1282              	.L55:
 525:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 526:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 527:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return E_FAIL;
 1283              		.loc 1 527 0
 1284 07d0 0123     		movs	r3, #1
 1285 07d2 30E0     		b	.L58
 1286              	.L54:
 528:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 529:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 530:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     infoLen += cborencoder_put_unsigned(&info[infoLen], length);
 1287              		.loc 1 530 0
 1288 07d4 97F82F30 		ldrb	r3, [r7, #47]	@ zero_extendqisi2
 1289 07d8 07F11002 		add	r2, r7, #16
 1290 07dc 1344     		add	r3, r3, r2
 1291 07de 97F84C20 		ldrb	r2, [r7, #76]	@ zero_extendqisi2
 1292 07e2 1146     		mov	r1, r2
 1293 07e4 1846     		mov	r0, r3
 1294 07e6 FFF7FEFF 		bl	cborencoder_put_unsigned
 1295 07ea 0346     		mov	r3, r0
 1296 07ec 1A46     		mov	r2, r3
 1297 07ee 97F82F30 		ldrb	r3, [r7, #47]
 1298 07f2 1344     		add	r3, r3, r2
 1299 07f4 87F82F30 		strb	r3, [r7, #47]
 531:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 532:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ret = hkdf(SHA256, masterSalt, masterSaltLen, masterSecret, masterSecretLen, info, infoLen, buf
 1300              		.loc 1 532 0
 1301 07f8 97F83800 		ldrb	r0, [r7, #56]	@ zero_extendqisi2
 1302 07fc FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1303 07fe 97F82F20 		ldrb	r2, [r7, #47]	@ zero_extendqisi2
 1304 0802 97F84C10 		ldrb	r1, [r7, #76]	@ zero_extendqisi2
 1305 0806 0491     		str	r1, [sp, #16]
 1306 0808 F968     		ldr	r1, [r7, #12]
 1307 080a 0391     		str	r1, [sp, #12]
 1308 080c 0292     		str	r2, [sp, #8]
 1309 080e 07F11002 		add	r2, r7, #16
 1310 0812 0192     		str	r2, [sp, #4]
 1311 0814 0093     		str	r3, [sp]
 1312 0816 BB68     		ldr	r3, [r7, #8]
 1313 0818 0246     		mov	r2, r0
 1314 081a 3968     		ldr	r1, [r7]
 1315 081c 0220     		movs	r0, #2
 1316 081e FFF7FEFF 		bl	hkdf
 1317 0822 0346     		mov	r3, r0
 1318 0824 87F82E30 		strb	r3, [r7, #46]
 533:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 534:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (ret == shaSuccess) {
 1319              		.loc 1 534 0
 1320 0828 97F82E30 		ldrb	r3, [r7, #46]	@ zero_extendqisi2
 1321 082c 002B     		cmp	r3, #0
 1322 082e 01D1     		bne	.L57
 535:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return E_SUCCESS;
 1323              		.loc 1 535 0
 1324 0830 0023     		movs	r3, #0
 1325 0832 00E0     		b	.L58
 1326              	.L57:
 536:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 537:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     return E_FAIL;
 1327              		.loc 1 537 0
 1328 0834 0123     		movs	r3, #1
 1329              	.L58:
 538:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 1330              		.loc 1 538 0 discriminator 1
 1331 0836 1846     		mov	r0, r3
 1332 0838 3037     		adds	r7, r7, #48
 1333              		.cfi_def_cfa_offset 8
 1334 083a BD46     		mov	sp, r7
 1335              		.cfi_def_cfa_register 13
 1336              		@ sp needed
 1337 083c 80BD     		pop	{r7, pc}
 1338              	.L60:
 1339 083e 00BF     		.align	2
 1340              	.L59:
 1341 0840 80000000 		.word	.LC0
 1342 0844 4B657900 		.word	7955787
 1343              		.cfi_endproc
 1344              	.LFE8:
 1346              		.align	1
 1347              		.global	is_request
 1348              		.syntax unified
 1349              		.thumb
 1350              		.thumb_func
 1351              		.fpu softvfp
 1353              	is_request:
 1354              	.LFB9:
 539:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 540:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** bool is_request(uint8_t code) {
 1355              		.loc 1 540 0
 1356              		.cfi_startproc
 1357              		@ args = 0, pretend = 0, frame = 8
 1358              		@ frame_needed = 1, uses_anonymous_args = 0
 1359              		@ link register save eliminated.
 1360 0848 80B4     		push	{r7}
 1361              		.cfi_def_cfa_offset 4
 1362              		.cfi_offset 7, -4
 1363 084a 83B0     		sub	sp, sp, #12
 1364              		.cfi_def_cfa_offset 16
 1365 084c 00AF     		add	r7, sp, #0
 1366              		.cfi_def_cfa_register 7
 1367 084e 0346     		mov	r3, r0
 1368 0850 FB71     		strb	r3, [r7, #7]
 541:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****    if ( code == (uint8_t) COAP_CODE_REQ_GET     ||
 1369              		.loc 1 541 0
 1370 0852 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1371 0854 012B     		cmp	r3, #1
 1372 0856 08D0     		beq	.L62
 1373              		.loc 1 541 0 is_stmt 0 discriminator 1
 1374 0858 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1375 085a 022B     		cmp	r3, #2
 1376 085c 05D0     		beq	.L62
 542:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         code == (uint8_t) COAP_CODE_REQ_POST    ||
 1377              		.loc 1 542 0 is_stmt 1
 1378 085e FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1379 0860 032B     		cmp	r3, #3
 1380 0862 02D0     		beq	.L62
 543:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         code == (uint8_t) COAP_CODE_REQ_PUT     ||
 1381              		.loc 1 543 0
 1382 0864 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1383 0866 042B     		cmp	r3, #4
 1384 0868 01D1     		bne	.L63
 1385              	.L62:
 544:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         code == (uint8_t) COAP_CODE_REQ_DELETE) {
 545:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return TRUE;
 1386              		.loc 1 545 0
 1387 086a 0123     		movs	r3, #1
 1388 086c 00E0     		b	.L64
 1389              	.L63:
 546:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****    }
 547:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****    else {
 548:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return FALSE;
 1390              		.loc 1 548 0
 1391 086e 0023     		movs	r3, #0
 1392              	.L64:
 549:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****    }
 550:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 1393              		.loc 1 550 0
 1394 0870 1846     		mov	r0, r3
 1395 0872 0C37     		adds	r7, r7, #12
 1396              		.cfi_def_cfa_offset 4
 1397 0874 BD46     		mov	sp, r7
 1398              		.cfi_def_cfa_register 13
 1399              		@ sp needed
 1400 0876 80BC     		pop	{r7}
 1401              		.cfi_restore 7
 1402              		.cfi_def_cfa_offset 0
 1403 0878 7047     		bx	lr
 1404              		.cfi_endproc
 1405              	.LFE9:
 1407              		.section	.rodata
 1408 0083 00       		.align	2
 1409              	.LC1:
 1410 0084 456E6372 		.ascii	"Encrypt0\000"
 1410      79707430 
 1410      00
 1411              		.text
 1412              		.align	1
 1413              		.global	openoscoap_construct_aad
 1414              		.syntax unified
 1415              		.thumb
 1416              		.thumb_func
 1417              		.fpu softvfp
 1419              	openoscoap_construct_aad:
 1420              	.LFB10:
 551:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 552:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** uint8_t openoscoap_construct_aad(uint8_t* buffer,
 553:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t version,
 554:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t code,
 555:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* optionsSerialized,
 556:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t optionsSerializedLen,
 557:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t aeadAlgorithm,
 558:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* requestKid,
 559:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t requestKidLen,
 560:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* requestSeq,
 561:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t requestSeqLen
 562:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         ) {
 1421              		.loc 1 562 0
 1422              		.cfi_startproc
 1423              		@ args = 24, pretend = 0, frame = 56
 1424              		@ frame_needed = 1, uses_anonymous_args = 0
 1425 087a 80B5     		push	{r7, lr}
 1426              		.cfi_def_cfa_offset 8
 1427              		.cfi_offset 7, -8
 1428              		.cfi_offset 14, -4
 1429 087c 8EB0     		sub	sp, sp, #56
 1430              		.cfi_def_cfa_offset 64
 1431 087e 00AF     		add	r7, sp, #0
 1432              		.cfi_def_cfa_register 7
 1433 0880 F860     		str	r0, [r7, #12]
 1434 0882 7B60     		str	r3, [r7, #4]
 1435 0884 0B46     		mov	r3, r1
 1436 0886 FB72     		strb	r3, [r7, #11]
 1437 0888 1346     		mov	r3, r2
 1438 088a BB72     		strb	r3, [r7, #10]
 563:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t externalAAD[EAAD_MAX_LEN];
 564:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t externalAADLen;
 565:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t ret;
 566:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     const uint8_t encrypt0[] = "Encrypt0";
 1439              		.loc 1 566 0
 1440 088c 6C4A     		ldr	r2, .L69
 1441 088e 07F11403 		add	r3, r7, #20
 1442 0892 07CA     		ldm	r2, {r0, r1, r2}
 1443 0894 03C3     		stmia	r3!, {r0, r1}
 1444 0896 1A70     		strb	r2, [r3]
 567:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 568:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ret = 0;
 1445              		.loc 1 568 0
 1446 0898 0023     		movs	r3, #0
 1447 089a 87F83730 		strb	r3, [r7, #55]
 569:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     externalAADLen = 0;
 1448              		.loc 1 569 0
 1449 089e 0023     		movs	r3, #0
 1450 08a0 87F83630 		strb	r3, [r7, #54]
 570:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 571:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_array(&externalAAD[externalAADLen], 6);
 1451              		.loc 1 571 0
 1452 08a4 97F83630 		ldrb	r3, [r7, #54]	@ zero_extendqisi2
 1453 08a8 07F12002 		add	r2, r7, #32
 1454 08ac 1344     		add	r3, r3, r2
 1455 08ae 0621     		movs	r1, #6
 1456 08b0 1846     		mov	r0, r3
 1457 08b2 FFF7FEFF 		bl	cborencoder_put_array
 1458 08b6 0346     		mov	r3, r0
 1459 08b8 1A46     		mov	r2, r3
 1460 08ba 97F83630 		ldrb	r3, [r7, #54]
 1461 08be 1344     		add	r3, r3, r2
 1462 08c0 87F83630 		strb	r3, [r7, #54]
 572:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_unsigned(&externalAAD[externalAADLen], version);
 1463              		.loc 1 572 0
 1464 08c4 97F83630 		ldrb	r3, [r7, #54]	@ zero_extendqisi2
 1465 08c8 07F12002 		add	r2, r7, #32
 1466 08cc 1344     		add	r3, r3, r2
 1467 08ce FA7A     		ldrb	r2, [r7, #11]	@ zero_extendqisi2
 1468 08d0 1146     		mov	r1, r2
 1469 08d2 1846     		mov	r0, r3
 1470 08d4 FFF7FEFF 		bl	cborencoder_put_unsigned
 1471 08d8 0346     		mov	r3, r0
 1472 08da 1A46     		mov	r2, r3
 1473 08dc 97F83630 		ldrb	r3, [r7, #54]
 1474 08e0 1344     		add	r3, r3, r2
 1475 08e2 87F83630 		strb	r3, [r7, #54]
 573:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_unsigned(&externalAAD[externalAADLen], code);
 1476              		.loc 1 573 0
 1477 08e6 97F83630 		ldrb	r3, [r7, #54]	@ zero_extendqisi2
 1478 08ea 07F12002 		add	r2, r7, #32
 1479 08ee 1344     		add	r3, r3, r2
 1480 08f0 BA7A     		ldrb	r2, [r7, #10]	@ zero_extendqisi2
 1481 08f2 1146     		mov	r1, r2
 1482 08f4 1846     		mov	r0, r3
 1483 08f6 FFF7FEFF 		bl	cborencoder_put_unsigned
 1484 08fa 0346     		mov	r3, r0
 1485 08fc 1A46     		mov	r2, r3
 1486 08fe 97F83630 		ldrb	r3, [r7, #54]
 1487 0902 1344     		add	r3, r3, r2
 1488 0904 87F83630 		strb	r3, [r7, #54]
 574:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_bytes(&externalAAD[externalAADLen], optionsSerialized, option
 1489              		.loc 1 574 0
 1490 0908 97F83630 		ldrb	r3, [r7, #54]	@ zero_extendqisi2
 1491 090c 07F12002 		add	r2, r7, #32
 1492 0910 1344     		add	r3, r3, r2
 1493 0912 97F84020 		ldrb	r2, [r7, #64]	@ zero_extendqisi2
 1494 0916 7968     		ldr	r1, [r7, #4]
 1495 0918 1846     		mov	r0, r3
 1496 091a FFF7FEFF 		bl	cborencoder_put_bytes
 1497 091e 0346     		mov	r3, r0
 1498 0920 1A46     		mov	r2, r3
 1499 0922 97F83630 		ldrb	r3, [r7, #54]
 1500 0926 1344     		add	r3, r3, r2
 1501 0928 87F83630 		strb	r3, [r7, #54]
 575:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_unsigned(&externalAAD[externalAADLen], aeadAlgorithm);
 1502              		.loc 1 575 0
 1503 092c 97F83630 		ldrb	r3, [r7, #54]	@ zero_extendqisi2
 1504 0930 07F12002 		add	r2, r7, #32
 1505 0934 1344     		add	r3, r3, r2
 1506 0936 97F84420 		ldrb	r2, [r7, #68]	@ zero_extendqisi2
 1507 093a 1146     		mov	r1, r2
 1508 093c 1846     		mov	r0, r3
 1509 093e FFF7FEFF 		bl	cborencoder_put_unsigned
 1510 0942 0346     		mov	r3, r0
 1511 0944 1A46     		mov	r2, r3
 1512 0946 97F83630 		ldrb	r3, [r7, #54]
 1513 094a 1344     		add	r3, r3, r2
 1514 094c 87F83630 		strb	r3, [r7, #54]
 576:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_bytes(&externalAAD[externalAADLen], requestKid, requestKidLen
 1515              		.loc 1 576 0
 1516 0950 97F83630 		ldrb	r3, [r7, #54]	@ zero_extendqisi2
 1517 0954 07F12002 		add	r2, r7, #32
 1518 0958 1344     		add	r3, r3, r2
 1519 095a 97F84C20 		ldrb	r2, [r7, #76]	@ zero_extendqisi2
 1520 095e B96C     		ldr	r1, [r7, #72]
 1521 0960 1846     		mov	r0, r3
 1522 0962 FFF7FEFF 		bl	cborencoder_put_bytes
 1523 0966 0346     		mov	r3, r0
 1524 0968 1A46     		mov	r2, r3
 1525 096a 97F83630 		ldrb	r3, [r7, #54]
 1526 096e 1344     		add	r3, r3, r2
 1527 0970 87F83630 		strb	r3, [r7, #54]
 577:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     externalAADLen += cborencoder_put_bytes(&externalAAD[externalAADLen], requestSeq, requestSeqLen
 1528              		.loc 1 577 0
 1529 0974 97F83630 		ldrb	r3, [r7, #54]	@ zero_extendqisi2
 1530 0978 07F12002 		add	r2, r7, #32
 1531 097c 1344     		add	r3, r3, r2
 1532 097e 97F85420 		ldrb	r2, [r7, #84]	@ zero_extendqisi2
 1533 0982 396D     		ldr	r1, [r7, #80]
 1534 0984 1846     		mov	r0, r3
 1535 0986 FFF7FEFF 		bl	cborencoder_put_bytes
 1536 098a 0346     		mov	r3, r0
 1537 098c 1A46     		mov	r2, r3
 1538 098e 97F83630 		ldrb	r3, [r7, #54]
 1539 0992 1344     		add	r3, r3, r2
 1540 0994 87F83630 		strb	r3, [r7, #54]
 578:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 579:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (externalAADLen > EAAD_MAX_LEN) {
 1541              		.loc 1 579 0
 1542 0998 97F83630 		ldrb	r3, [r7, #54]	@ zero_extendqisi2
 1543 099c 132B     		cmp	r3, #19
 1544 099e 07D9     		bls	.L66
 580:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         // corruption
 581:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         openserial_printError(
 1545              		.loc 1 581 0
 1546 09a0 0023     		movs	r3, #0
 1547 09a2 0022     		movs	r2, #0
 1548 09a4 4721     		movs	r1, #71
 1549 09a6 2820     		movs	r0, #40
 1550 09a8 FFF7FEFF 		bl	openserial_printError
 582:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 COMPONENT_OPENOSCOAP,ERR_BUFFER_OVERFLOW,
 583:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0,
 584:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****                 (errorparameter_t)0
 585:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         );
 586:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return 0;
 1551              		.loc 1 586 0
 1552 09ac 0023     		movs	r3, #0
 1553 09ae 43E0     		b	.L68
 1554              	.L66:
 587:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 588:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 589:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ret += cborencoder_put_array(&buffer[ret], 3); // COSE Encrypt0 structure with 3 elements
 1555              		.loc 1 589 0
 1556 09b0 97F83730 		ldrb	r3, [r7, #55]	@ zero_extendqisi2
 1557 09b4 FA68     		ldr	r2, [r7, #12]
 1558 09b6 1344     		add	r3, r3, r2
 1559 09b8 0321     		movs	r1, #3
 1560 09ba 1846     		mov	r0, r3
 1561 09bc FFF7FEFF 		bl	cborencoder_put_array
 1562 09c0 0346     		mov	r3, r0
 1563 09c2 1A46     		mov	r2, r3
 1564 09c4 97F83730 		ldrb	r3, [r7, #55]
 1565 09c8 1344     		add	r3, r3, r2
 1566 09ca 87F83730 		strb	r3, [r7, #55]
 590:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // first element: "Encrypt0"
 591:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ret += cborencoder_put_text(&buffer[ret], (char *) encrypt0, sizeof(encrypt0) - 1);
 1567              		.loc 1 591 0
 1568 09ce 97F83730 		ldrb	r3, [r7, #55]	@ zero_extendqisi2
 1569 09d2 FA68     		ldr	r2, [r7, #12]
 1570 09d4 1344     		add	r3, r3, r2
 1571 09d6 07F11401 		add	r1, r7, #20
 1572 09da 0822     		movs	r2, #8
 1573 09dc 1846     		mov	r0, r3
 1574 09de FFF7FEFF 		bl	cborencoder_put_text
 1575 09e2 0346     		mov	r3, r0
 1576 09e4 1A46     		mov	r2, r3
 1577 09e6 97F83730 		ldrb	r3, [r7, #55]
 1578 09ea 1344     		add	r3, r3, r2
 1579 09ec 87F83730 		strb	r3, [r7, #55]
 592:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // second element: empty byte string
 593:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ret += cborencoder_put_bytes(&buffer[ret], NULL, 0);
 1580              		.loc 1 593 0
 1581 09f0 97F83730 		ldrb	r3, [r7, #55]	@ zero_extendqisi2
 1582 09f4 FA68     		ldr	r2, [r7, #12]
 1583 09f6 1344     		add	r3, r3, r2
 1584 09f8 0022     		movs	r2, #0
 1585 09fa 0021     		movs	r1, #0
 1586 09fc 1846     		mov	r0, r3
 1587 09fe FFF7FEFF 		bl	cborencoder_put_bytes
 1588 0a02 0346     		mov	r3, r0
 1589 0a04 1A46     		mov	r2, r3
 1590 0a06 97F83730 		ldrb	r3, [r7, #55]
 1591 0a0a 1344     		add	r3, r3, r2
 1592 0a0c 87F83730 		strb	r3, [r7, #55]
 594:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // third element: external AAD from OSCOAP
 595:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     ret += cborencoder_put_bytes(&buffer[ret], externalAAD, externalAADLen);
 1593              		.loc 1 595 0
 1594 0a10 97F83730 		ldrb	r3, [r7, #55]	@ zero_extendqisi2
 1595 0a14 FA68     		ldr	r2, [r7, #12]
 1596 0a16 1344     		add	r3, r3, r2
 1597 0a18 97F83620 		ldrb	r2, [r7, #54]	@ zero_extendqisi2
 1598 0a1c 07F12001 		add	r1, r7, #32
 1599 0a20 1846     		mov	r0, r3
 1600 0a22 FFF7FEFF 		bl	cborencoder_put_bytes
 1601 0a26 0346     		mov	r3, r0
 1602 0a28 1A46     		mov	r2, r3
 1603 0a2a 97F83730 		ldrb	r3, [r7, #55]
 1604 0a2e 1344     		add	r3, r3, r2
 1605 0a30 87F83730 		strb	r3, [r7, #55]
 596:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 597:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     return ret;
 1606              		.loc 1 597 0
 1607 0a34 97F83730 		ldrb	r3, [r7, #55]	@ zero_extendqisi2
 1608              	.L68:
 598:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 1609              		.loc 1 598 0 discriminator 1
 1610 0a38 1846     		mov	r0, r3
 1611 0a3a 3837     		adds	r7, r7, #56
 1612              		.cfi_def_cfa_offset 8
 1613 0a3c BD46     		mov	sp, r7
 1614              		.cfi_def_cfa_register 13
 1615              		@ sp needed
 1616 0a3e 80BD     		pop	{r7, pc}
 1617              	.L70:
 1618              		.align	2
 1619              	.L69:
 1620 0a40 84000000 		.word	.LC1
 1621              		.cfi_endproc
 1622              	.LFE10:
 1624              		.align	1
 1625              		.global	openoscoap_encode_compressed_COSE
 1626              		.syntax unified
 1627              		.thumb
 1628              		.thumb_func
 1629              		.fpu softvfp
 1631              	openoscoap_encode_compressed_COSE:
 1632              	.LFB11:
 599:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 600:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** void openoscoap_encode_compressed_COSE(OpenQueueEntry_t* msg,
 601:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* partialIV, uint8_t partialIVLen,
 602:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t* kid,
 603:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         uint8_t kidLen) {
 1633              		.loc 1 603 0
 1634              		.cfi_startproc
 1635              		@ args = 4, pretend = 0, frame = 24
 1636              		@ frame_needed = 1, uses_anonymous_args = 0
 1637 0a44 80B5     		push	{r7, lr}
 1638              		.cfi_def_cfa_offset 8
 1639              		.cfi_offset 7, -8
 1640              		.cfi_offset 14, -4
 1641 0a46 86B0     		sub	sp, sp, #24
 1642              		.cfi_def_cfa_offset 32
 1643 0a48 00AF     		add	r7, sp, #0
 1644              		.cfi_def_cfa_register 7
 1645 0a4a F860     		str	r0, [r7, #12]
 1646 0a4c B960     		str	r1, [r7, #8]
 1647 0a4e 3B60     		str	r3, [r7]
 1648 0a50 1346     		mov	r3, r2
 1649 0a52 FB71     		strb	r3, [r7, #7]
 604:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // ciphertext is already encoded and of length msg->length
 605:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t kidFlag;
 606:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 607:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (kidLen != 0) {
 1650              		.loc 1 607 0
 1651 0a54 97F82030 		ldrb	r3, [r7, #32]	@ zero_extendqisi2
 1652 0a58 002B     		cmp	r3, #0
 1653 0a5a 02D0     		beq	.L72
 608:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         kidFlag = 1;
 1654              		.loc 1 608 0
 1655 0a5c 0123     		movs	r3, #1
 1656 0a5e FB75     		strb	r3, [r7, #23]
 1657 0a60 01E0     		b	.L73
 1658              	.L72:
 609:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 610:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 611:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         kidFlag = 0;
 1659              		.loc 1 611 0
 1660 0a62 0023     		movs	r3, #0
 1661 0a64 FB75     		strb	r3, [r7, #23]
 1662              	.L73:
 612:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 613:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 614:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (kidFlag) {
 1663              		.loc 1 614 0
 1664 0a66 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1665 0a68 002B     		cmp	r3, #0
 1666 0a6a 15D0     		beq	.L74
 615:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         packetfunctions_reserveHeaderSize(msg, kidLen + 1);
 1667              		.loc 1 615 0
 1668 0a6c 97F82030 		ldrb	r3, [r7, #32]
 1669 0a70 0133     		adds	r3, r3, #1
 1670 0a72 DBB2     		uxtb	r3, r3
 1671 0a74 1946     		mov	r1, r3
 1672 0a76 F868     		ldr	r0, [r7, #12]
 1673 0a78 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 616:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         msg->payload[0] = kidLen;
 1674              		.loc 1 616 0
 1675 0a7c FB68     		ldr	r3, [r7, #12]
 1676 0a7e 5B68     		ldr	r3, [r3, #4]
 1677 0a80 97F82020 		ldrb	r2, [r7, #32]
 1678 0a84 1A70     		strb	r2, [r3]
 617:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         memcpy(&msg->payload[1], kid, kidLen);
 1679              		.loc 1 617 0
 1680 0a86 FB68     		ldr	r3, [r7, #12]
 1681 0a88 5B68     		ldr	r3, [r3, #4]
 1682 0a8a 0133     		adds	r3, r3, #1
 1683 0a8c 97F82020 		ldrb	r2, [r7, #32]	@ zero_extendqisi2
 1684 0a90 3968     		ldr	r1, [r7]
 1685 0a92 1846     		mov	r0, r3
 1686 0a94 FFF7FEFF 		bl	memcpy
 1687              	.L74:
 618:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 619:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 620:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (partialIVLen) {
 1688              		.loc 1 620 0
 1689 0a98 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1690 0a9a 002B     		cmp	r3, #0
 1691 0a9c 0BD0     		beq	.L75
 621:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         packetfunctions_reserveHeaderSize(msg, partialIVLen);
 1692              		.loc 1 621 0
 1693 0a9e FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1694 0aa0 1946     		mov	r1, r3
 1695 0aa2 F868     		ldr	r0, [r7, #12]
 1696 0aa4 FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 622:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         memcpy(&msg->payload[0], partialIV, partialIVLen);
 1697              		.loc 1 622 0
 1698 0aa8 FB68     		ldr	r3, [r7, #12]
 1699 0aaa 5B68     		ldr	r3, [r3, #4]
 1700 0aac FA79     		ldrb	r2, [r7, #7]	@ zero_extendqisi2
 1701 0aae B968     		ldr	r1, [r7, #8]
 1702 0ab0 1846     		mov	r0, r3
 1703 0ab2 FFF7FEFF 		bl	memcpy
 1704              	.L75:
 623:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 624:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // flag byte
 625:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     packetfunctions_reserveHeaderSize(msg, 1);
 1705              		.loc 1 625 0
 1706 0ab6 0121     		movs	r1, #1
 1707 0ab8 F868     		ldr	r0, [r7, #12]
 1708 0aba FFF7FEFF 		bl	packetfunctions_reserveHeaderSize
 626:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     msg->payload[0] = ((kidFlag << 3) | partialIVLen);
 1709              		.loc 1 626 0
 1710 0abe FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1711 0ac0 DB00     		lsls	r3, r3, #3
 1712 0ac2 5AB2     		sxtb	r2, r3
 1713 0ac4 97F90730 		ldrsb	r3, [r7, #7]
 1714 0ac8 1343     		orrs	r3, r3, r2
 1715 0aca 5AB2     		sxtb	r2, r3
 1716 0acc FB68     		ldr	r3, [r7, #12]
 1717 0ace 5B68     		ldr	r3, [r3, #4]
 1718 0ad0 D2B2     		uxtb	r2, r2
 1719 0ad2 1A70     		strb	r2, [r3]
 627:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 1720              		.loc 1 627 0
 1721 0ad4 00BF     		nop
 1722 0ad6 1837     		adds	r7, r7, #24
 1723              		.cfi_def_cfa_offset 8
 1724 0ad8 BD46     		mov	sp, r7
 1725              		.cfi_def_cfa_register 13
 1726              		@ sp needed
 1727 0ada 80BD     		pop	{r7, pc}
 1728              		.cfi_endproc
 1729              	.LFE11:
 1731              		.align	1
 1732              		.global	xor_arrays
 1733              		.syntax unified
 1734              		.thumb
 1735              		.thumb_func
 1736              		.fpu softvfp
 1738              	xor_arrays:
 1739              	.LFB12:
 628:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 629:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 630:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** void xor_arrays(uint8_t* s1, uint8_t* s2, uint8_t* dst, uint8_t len) {
 1740              		.loc 1 630 0
 1741              		.cfi_startproc
 1742              		@ args = 0, pretend = 0, frame = 24
 1743              		@ frame_needed = 1, uses_anonymous_args = 0
 1744              		@ link register save eliminated.
 1745 0adc 80B4     		push	{r7}
 1746              		.cfi_def_cfa_offset 4
 1747              		.cfi_offset 7, -4
 1748 0ade 87B0     		sub	sp, sp, #28
 1749              		.cfi_def_cfa_offset 32
 1750 0ae0 00AF     		add	r7, sp, #0
 1751              		.cfi_def_cfa_register 7
 1752 0ae2 F860     		str	r0, [r7, #12]
 1753 0ae4 B960     		str	r1, [r7, #8]
 1754 0ae6 7A60     		str	r2, [r7, #4]
 1755 0ae8 FB70     		strb	r3, [r7, #3]
 631:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint8_t i;
 632:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     for (i = 0; i < len; i++) {
 1756              		.loc 1 632 0
 1757 0aea 0023     		movs	r3, #0
 1758 0aec FB75     		strb	r3, [r7, #23]
 1759 0aee 10E0     		b	.L77
 1760              	.L78:
 633:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         dst[i] = s1[i] ^ s2[i];
 1761              		.loc 1 633 0 discriminator 3
 1762 0af0 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1763 0af2 FA68     		ldr	r2, [r7, #12]
 1764 0af4 1344     		add	r3, r3, r2
 1765 0af6 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 1766 0af8 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1767 0afa BA68     		ldr	r2, [r7, #8]
 1768 0afc 1344     		add	r3, r3, r2
 1769 0afe 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1770 0b00 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1771 0b02 7868     		ldr	r0, [r7, #4]
 1772 0b04 0344     		add	r3, r3, r0
 1773 0b06 4A40     		eors	r2, r2, r1
 1774 0b08 D2B2     		uxtb	r2, r2
 1775 0b0a 1A70     		strb	r2, [r3]
 632:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         dst[i] = s1[i] ^ s2[i];
 1776              		.loc 1 632 0 discriminator 3
 1777 0b0c FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 1778 0b0e 0133     		adds	r3, r3, #1
 1779 0b10 FB75     		strb	r3, [r7, #23]
 1780              	.L77:
 632:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         dst[i] = s1[i] ^ s2[i];
 1781              		.loc 1 632 0 is_stmt 0 discriminator 1
 1782 0b12 FA7D     		ldrb	r2, [r7, #23]	@ zero_extendqisi2
 1783 0b14 FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
 1784 0b16 9A42     		cmp	r2, r3
 1785 0b18 EAD3     		bcc	.L78
 634:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 635:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 1786              		.loc 1 635 0 is_stmt 1
 1787 0b1a 00BF     		nop
 1788 0b1c 1C37     		adds	r7, r7, #28
 1789              		.cfi_def_cfa_offset 4
 1790 0b1e BD46     		mov	sp, r7
 1791              		.cfi_def_cfa_register 13
 1792              		@ sp needed
 1793 0b20 80BC     		pop	{r7}
 1794              		.cfi_restore 7
 1795              		.cfi_def_cfa_offset 0
 1796 0b22 7047     		bx	lr
 1797              		.cfi_endproc
 1798              	.LFE12:
 1800              		.align	1
 1801              		.global	flip_first_bit
 1802              		.syntax unified
 1803              		.thumb
 1804              		.thumb_func
 1805              		.fpu softvfp
 1807              	flip_first_bit:
 1808              	.LFB13:
 636:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 637:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** void flip_first_bit(uint8_t* source, uint8_t* dst, uint8_t len){
 1809              		.loc 1 637 0
 1810              		.cfi_startproc
 1811              		@ args = 0, pretend = 0, frame = 16
 1812              		@ frame_needed = 1, uses_anonymous_args = 0
 1813 0b24 80B5     		push	{r7, lr}
 1814              		.cfi_def_cfa_offset 8
 1815              		.cfi_offset 7, -8
 1816              		.cfi_offset 14, -4
 1817 0b26 84B0     		sub	sp, sp, #16
 1818              		.cfi_def_cfa_offset 24
 1819 0b28 00AF     		add	r7, sp, #0
 1820              		.cfi_def_cfa_register 7
 1821 0b2a F860     		str	r0, [r7, #12]
 1822 0b2c B960     		str	r1, [r7, #8]
 1823 0b2e 1346     		mov	r3, r2
 1824 0b30 FB71     		strb	r3, [r7, #7]
 638:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     memcpy(dst, source, len);
 1825              		.loc 1 638 0
 1826 0b32 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 1827 0b34 1A46     		mov	r2, r3
 1828 0b36 F968     		ldr	r1, [r7, #12]
 1829 0b38 B868     		ldr	r0, [r7, #8]
 1830 0b3a FFF7FEFF 		bl	memcpy
 639:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     dst[0] = dst[0] ^ 0x80;
 1831              		.loc 1 639 0
 1832 0b3e BB68     		ldr	r3, [r7, #8]
 1833 0b40 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1834 0b42 83F07F03 		eor	r3, r3, #127
 1835 0b46 DB43     		mvns	r3, r3
 1836 0b48 DAB2     		uxtb	r2, r3
 1837 0b4a BB68     		ldr	r3, [r7, #8]
 1838 0b4c 1A70     		strb	r2, [r3]
 640:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 1839              		.loc 1 640 0
 1840 0b4e 00BF     		nop
 1841 0b50 1037     		adds	r7, r7, #16
 1842              		.cfi_def_cfa_offset 8
 1843 0b52 BD46     		mov	sp, r7
 1844              		.cfi_def_cfa_register 13
 1845              		@ sp needed
 1846 0b54 80BD     		pop	{r7, pc}
 1847              		.cfi_endproc
 1848              	.LFE13:
 1850              		.align	1
 1851              		.global	replay_window_check
 1852              		.syntax unified
 1853              		.thumb
 1854              		.thumb_func
 1855              		.fpu softvfp
 1857              	replay_window_check:
 1858              	.LFB14:
 641:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 642:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** bool replay_window_check(oscoap_security_context_t *context, uint16_t sequenceNumber) {
 1859              		.loc 1 642 0
 1860              		.cfi_startproc
 1861              		@ args = 0, pretend = 0, frame = 16
 1862              		@ frame_needed = 1, uses_anonymous_args = 0
 1863              		@ link register save eliminated.
 1864 0b56 80B4     		push	{r7}
 1865              		.cfi_def_cfa_offset 4
 1866              		.cfi_offset 7, -4
 1867 0b58 85B0     		sub	sp, sp, #20
 1868              		.cfi_def_cfa_offset 24
 1869 0b5a 00AF     		add	r7, sp, #0
 1870              		.cfi_def_cfa_register 7
 1871 0b5c 7860     		str	r0, [r7, #4]
 1872 0b5e 0B46     		mov	r3, r1
 1873 0b60 7B80     		strh	r3, [r7, #2]	@ movhi
 643:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint16_t delta;
 644:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 645:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // packets lower than the left edge are rejected
 646:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if ((int)sequenceNumber < (int)(context->window.rightEdge - 31)) {
 1874              		.loc 1 646 0
 1875 0b62 7A88     		ldrh	r2, [r7, #2]
 1876 0b64 7B68     		ldr	r3, [r7, #4]
 1877 0b66 B3F85830 		ldrh	r3, [r3, #88]
 1878 0b6a 1F3B     		subs	r3, r3, #31
 1879 0b6c 9A42     		cmp	r2, r3
 1880 0b6e 01DA     		bge	.L81
 647:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return FALSE;
 1881              		.loc 1 647 0
 1882 0b70 0023     		movs	r3, #0
 1883 0b72 1AE0     		b	.L82
 1884              	.L81:
 648:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 649:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 650:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // packets higher than the right edge are accepted
 651:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (sequenceNumber > context->window.rightEdge) {
 1885              		.loc 1 651 0
 1886 0b74 7B68     		ldr	r3, [r7, #4]
 1887 0b76 B3F85830 		ldrh	r3, [r3, #88]
 1888 0b7a 7A88     		ldrh	r2, [r7, #2]
 1889 0b7c 9A42     		cmp	r2, r3
 1890 0b7e 01D9     		bls	.L83
 652:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return TRUE;
 1891              		.loc 1 652 0
 1892 0b80 0123     		movs	r3, #1
 1893 0b82 12E0     		b	.L82
 1894              	.L83:
 653:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 654:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 655:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     // packet falls within the window, check if appropriate bit is set
 656:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     delta = context->window.rightEdge - sequenceNumber;
 1895              		.loc 1 656 0
 1896 0b84 7B68     		ldr	r3, [r7, #4]
 1897 0b86 B3F85820 		ldrh	r2, [r3, #88]
 1898 0b8a 7B88     		ldrh	r3, [r7, #2]	@ movhi
 1899 0b8c D31A     		subs	r3, r2, r3
 1900 0b8e FB81     		strh	r3, [r7, #14]	@ movhi
 657:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if ((uint32_t)(1 << delta) & context->window.bitArray) {
 1901              		.loc 1 657 0
 1902 0b90 FB89     		ldrh	r3, [r7, #14]
 1903 0b92 0122     		movs	r2, #1
 1904 0b94 02FA03F3 		lsl	r3, r2, r3
 1905 0b98 1A46     		mov	r2, r3
 1906 0b9a 7B68     		ldr	r3, [r7, #4]
 1907 0b9c 5B6D     		ldr	r3, [r3, #84]
 1908 0b9e 1340     		ands	r3, r3, r2
 1909 0ba0 002B     		cmp	r3, #0
 1910 0ba2 01D0     		beq	.L84
 658:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return FALSE;
 1911              		.loc 1 658 0
 1912 0ba4 0023     		movs	r3, #0
 1913 0ba6 00E0     		b	.L82
 1914              	.L84:
 659:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 660:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 661:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     return TRUE;
 1915              		.loc 1 661 0
 1916 0ba8 0123     		movs	r3, #1
 1917              	.L82:
 662:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 1918              		.loc 1 662 0
 1919 0baa 1846     		mov	r0, r3
 1920 0bac 1437     		adds	r7, r7, #20
 1921              		.cfi_def_cfa_offset 4
 1922 0bae BD46     		mov	sp, r7
 1923              		.cfi_def_cfa_register 13
 1924              		@ sp needed
 1925 0bb0 80BC     		pop	{r7}
 1926              		.cfi_restore 7
 1927              		.cfi_def_cfa_offset 0
 1928 0bb2 7047     		bx	lr
 1929              		.cfi_endproc
 1930              	.LFE14:
 1932              		.align	1
 1933              		.global	replay_window_update
 1934              		.syntax unified
 1935              		.thumb
 1936              		.thumb_func
 1937              		.fpu softvfp
 1939              	replay_window_update:
 1940              	.LFB15:
 663:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 664:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** void replay_window_update(oscoap_security_context_t *context, uint16_t sequenceNumber) {
 1941              		.loc 1 664 0
 1942              		.cfi_startproc
 1943              		@ args = 0, pretend = 0, frame = 16
 1944              		@ frame_needed = 1, uses_anonymous_args = 0
 1945 0bb4 80B5     		push	{r7, lr}
 1946              		.cfi_def_cfa_offset 8
 1947              		.cfi_offset 7, -8
 1948              		.cfi_offset 14, -4
 1949 0bb6 84B0     		sub	sp, sp, #16
 1950              		.cfi_def_cfa_offset 24
 1951 0bb8 00AF     		add	r7, sp, #0
 1952              		.cfi_def_cfa_register 7
 1953 0bba 7860     		str	r0, [r7, #4]
 1954 0bbc 0B46     		mov	r3, r1
 1955 0bbe 7B80     		strh	r3, [r7, #2]	@ movhi
 665:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     uint16_t delta;
 666:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 667:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (replay_window_check(context, sequenceNumber) == FALSE) {
 1956              		.loc 1 667 0
 1957 0bc0 7B88     		ldrh	r3, [r7, #2]
 1958 0bc2 1946     		mov	r1, r3
 1959 0bc4 7868     		ldr	r0, [r7, #4]
 1960 0bc6 FFF7FEFF 		bl	replay_window_check
 1961 0bca 0346     		mov	r3, r0
 1962 0bcc 83F00103 		eor	r3, r3, #1
 1963 0bd0 DBB2     		uxtb	r3, r3
 1964 0bd2 002B     		cmp	r3, #0
 1965 0bd4 36D1     		bne	.L91
 668:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return;
 669:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 670:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 671:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (sequenceNumber > context->window.rightEdge) {
 1966              		.loc 1 671 0
 1967 0bd6 7B68     		ldr	r3, [r7, #4]
 1968 0bd8 B3F85830 		ldrh	r3, [r3, #88]
 1969 0bdc 7A88     		ldrh	r2, [r7, #2]
 1970 0bde 9A42     		cmp	r2, r3
 1971 0be0 1DD9     		bls	.L88
 672:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         delta = sequenceNumber - context->window.rightEdge;
 1972              		.loc 1 672 0
 1973 0be2 7B68     		ldr	r3, [r7, #4]
 1974 0be4 B3F85830 		ldrh	r3, [r3, #88]
 1975 0be8 7A88     		ldrh	r2, [r7, #2]	@ movhi
 1976 0bea D31A     		subs	r3, r2, r3
 1977 0bec FB81     		strh	r3, [r7, #14]	@ movhi
 673:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         context->window.rightEdge = sequenceNumber;
 1978              		.loc 1 673 0
 1979 0bee 7B68     		ldr	r3, [r7, #4]
 1980 0bf0 7A88     		ldrh	r2, [r7, #2]	@ movhi
 1981 0bf2 A3F85820 		strh	r2, [r3, #88]	@ movhi
 674:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         if (delta < 32) {
 1982              		.loc 1 674 0
 1983 0bf6 FB89     		ldrh	r3, [r7, #14]
 1984 0bf8 1F2B     		cmp	r3, #31
 1985 0bfa 06D8     		bhi	.L89
 675:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             context->window.bitArray = context->window.bitArray << delta;
 1986              		.loc 1 675 0
 1987 0bfc 7B68     		ldr	r3, [r7, #4]
 1988 0bfe 5A6D     		ldr	r2, [r3, #84]
 1989 0c00 FB89     		ldrh	r3, [r7, #14]
 1990 0c02 9A40     		lsls	r2, r2, r3
 1991 0c04 7B68     		ldr	r3, [r7, #4]
 1992 0c06 5A65     		str	r2, [r3, #84]
 1993 0c08 02E0     		b	.L90
 1994              	.L89:
 676:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         }
 677:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         else {
 678:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             context->window.bitArray = 0x00;
 1995              		.loc 1 678 0
 1996 0c0a 7B68     		ldr	r3, [r7, #4]
 1997 0c0c 0022     		movs	r2, #0
 1998 0c0e 5A65     		str	r2, [r3, #84]
 1999              	.L90:
 679:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         }
 680:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         context->window.bitArray |= 1; // update the right edge bit
 2000              		.loc 1 680 0
 2001 0c10 7B68     		ldr	r3, [r7, #4]
 2002 0c12 5B6D     		ldr	r3, [r3, #84]
 2003 0c14 43F00102 		orr	r2, r3, #1
 2004 0c18 7B68     		ldr	r3, [r7, #4]
 2005 0c1a 5A65     		str	r2, [r3, #84]
 2006 0c1c 13E0     		b	.L85
 2007              	.L88:
 681:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 682:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 683:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         delta = context->window.rightEdge - sequenceNumber;
 2008              		.loc 1 683 0
 2009 0c1e 7B68     		ldr	r3, [r7, #4]
 2010 0c20 B3F85820 		ldrh	r2, [r3, #88]
 2011 0c24 7B88     		ldrh	r3, [r7, #2]	@ movhi
 2012 0c26 D31A     		subs	r3, r2, r3
 2013 0c28 FB81     		strh	r3, [r7, #14]	@ movhi
 684:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         if (delta < 32) {
 2014              		.loc 1 684 0
 2015 0c2a FB89     		ldrh	r3, [r7, #14]
 2016 0c2c 1F2B     		cmp	r3, #31
 2017 0c2e 0AD8     		bhi	.L85
 685:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****             context->window.bitArray |= 1 << delta;
 2018              		.loc 1 685 0
 2019 0c30 7B68     		ldr	r3, [r7, #4]
 2020 0c32 5B6D     		ldr	r3, [r3, #84]
 2021 0c34 FA89     		ldrh	r2, [r7, #14]
 2022 0c36 0121     		movs	r1, #1
 2023 0c38 01FA02F2 		lsl	r2, r1, r2
 2024 0c3c 1A43     		orrs	r2, r2, r3
 2025 0c3e 7B68     		ldr	r3, [r7, #4]
 2026 0c40 5A65     		str	r2, [r3, #84]
 2027 0c42 00E0     		b	.L85
 2028              	.L91:
 668:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 2029              		.loc 1 668 0
 2030 0c44 00BF     		nop
 2031              	.L85:
 686:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         }
 687:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 688:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 2032              		.loc 1 688 0
 2033 0c46 1037     		adds	r7, r7, #16
 2034              		.cfi_def_cfa_offset 8
 2035 0c48 BD46     		mov	sp, r7
 2036              		.cfi_def_cfa_register 13
 2037              		@ sp needed
 2038 0c4a 80BD     		pop	{r7, pc}
 2039              		.cfi_endproc
 2040              	.LFE15:
 2042              		.align	1
 2043              		.global	openoscoap_convert_sequence_number
 2044              		.syntax unified
 2045              		.thumb
 2046              		.thumb_func
 2047              		.fpu softvfp
 2049              	openoscoap_convert_sequence_number:
 2050              	.LFB16:
 689:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** 
 690:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** uint8_t openoscoap_convert_sequence_number(uint16_t sequenceNumber, uint8_t** buffer) {
 2051              		.loc 1 690 0
 2052              		.cfi_startproc
 2053              		@ args = 0, pretend = 0, frame = 8
 2054              		@ frame_needed = 1, uses_anonymous_args = 0
 2055 0c4c 80B5     		push	{r7, lr}
 2056              		.cfi_def_cfa_offset 8
 2057              		.cfi_offset 7, -8
 2058              		.cfi_offset 14, -4
 2059 0c4e 82B0     		sub	sp, sp, #8
 2060              		.cfi_def_cfa_offset 16
 2061 0c50 00AF     		add	r7, sp, #0
 2062              		.cfi_def_cfa_register 7
 2063 0c52 0346     		mov	r3, r0
 2064 0c54 3960     		str	r1, [r7]
 2065 0c56 FB80     		strh	r3, [r7, #6]	@ movhi
 691:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     packetfunctions_htons(sequenceNumber, *buffer);
 2066              		.loc 1 691 0
 2067 0c58 3B68     		ldr	r3, [r7]
 2068 0c5a 1A68     		ldr	r2, [r3]
 2069 0c5c FB88     		ldrh	r3, [r7, #6]
 2070 0c5e 1146     		mov	r1, r2
 2071 0c60 1846     		mov	r0, r3
 2072 0c62 FFF7FEFF 		bl	packetfunctions_htons
 692:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     if (**buffer == 0x00) {
 2073              		.loc 1 692 0
 2074 0c66 3B68     		ldr	r3, [r7]
 2075 0c68 1B68     		ldr	r3, [r3]
 2076 0c6a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2077 0c6c 002B     		cmp	r3, #0
 2078 0c6e 06D1     		bne	.L93
 693:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         (*buffer)++;
 2079              		.loc 1 693 0
 2080 0c70 3B68     		ldr	r3, [r7]
 2081 0c72 1B68     		ldr	r3, [r3]
 2082 0c74 5A1C     		adds	r2, r3, #1
 2083 0c76 3B68     		ldr	r3, [r7]
 2084 0c78 1A60     		str	r2, [r3]
 694:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return 1;
 2085              		.loc 1 694 0
 2086 0c7a 0123     		movs	r3, #1
 2087 0c7c 00E0     		b	.L94
 2088              	.L93:
 695:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 696:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     else {
 697:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****         return 2;
 2089              		.loc 1 697 0
 2090 0c7e 0223     		movs	r3, #2
 2091              	.L94:
 698:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c ****     }
 699:build\openmote-cc2538_armgcc\openapps\opencoap/openoscoap.c **** }
 2092              		.loc 1 699 0
 2093 0c80 1846     		mov	r0, r3
 2094 0c82 0837     		adds	r7, r7, #8
 2095              		.cfi_def_cfa_offset 8
 2096 0c84 BD46     		mov	sp, r7
 2097              		.cfi_def_cfa_register 13
 2098              		@ sp needed
 2099 0c86 80BD     		pop	{r7, pc}
 2100              		.cfi_endproc
 2101              	.LFE16:
 2103              	.Letext0:
 2104              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 2105              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 2106              		.file 4 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 2107              		.file 5 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 2108              		.file 6 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\lib\\gcc\\arm-none-eab
 2109              		.file 7 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 2110              		.file 8 "bsp\\boards\\openmote-cc2538/board_info.h"
 2111              		.file 9 "inc/opendefs.h"
 2112              		.file 10 "build\\openmote-cc2538_armgcc\\openapps\\opencoap\\opencoap.h"
 2113              		.file 11 "build\\openmote-cc2538_armgcc\\openapps\\opencoap\\openoscoap.h"
 2114              		.file 12 "build\\openmote-cc2538_armgcc\\openapps\\opencoap\\sha.h"
DEFINED SYMBOLS
                            *ABS*:00000000 openoscoap.c
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:16     .rodata:00000000 $d
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:19     .rodata:00000000 rreg_uriquery
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:24     .rodata:00000008 infoBoardname
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:29     .rodata:00000010 infouCName
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:34     .rodata:00000018 infoRadioName
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:39     .rodata:00000024 infoStackName
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:44     .rodata:00000030 ipAddr_ipsoRD
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:64     .rodata:00000040 ipAddr_motesEecs
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:84     .rodata:00000050 ipAddr_local
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:104    .rodata:00000060 ipAddr_motedata
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:124    .rodata:00000070 ipAddr_ringmaster
                            *COM*:00000001 openoscoap_vars
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:143    .text:00000000 $t
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:150    .text:00000000 openoscoap_init_security_context
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1173   .text:000006e0 hkdf_derive_parameter
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:314    .text:0000011a openoscoap_protect_message
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:2049   .text:00000c4c openoscoap_convert_sequence_number
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1353   .text:00000848 is_request
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1419   .text:0000087a openoscoap_construct_aad
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1738   .text:00000adc xor_arrays
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1807   .text:00000b24 flip_first_bit
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1631   .text:00000a44 openoscoap_encode_compressed_COSE
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:636    .text:00000384 openoscoap_unprotect_message
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1857   .text:00000b56 replay_window_check
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1939   .text:00000bb4 replay_window_update
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:950    .text:000005ce openoscoap_get_sequence_number
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1008   .text:00000608 openoscoap_parse_compressed_COSE
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1341   .text:00000840 $d
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1346   .text:00000848 $t
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1620   .text:00000a40 $d
C:\Users\Lee\AppData\Local\Temp\ccAMl7MJ.s:1624   .text:00000a44 $t
                           .group:00000000 wm4.0.93d65e4ff05d5af51629690e5b534e57
                           .group:00000000 wm4._newlib_version.h.4.875b979a44719054cd750d0952ad3fd6
                           .group:00000000 wm4.features.h.33.318b64d71e0957639cfb30f1db1f7ec8
                           .group:00000000 wm4._default_types.h.15.247e5cd201eca3442cbf5404108c4935
                           .group:00000000 wm4._intsup.h.10.cce27fed8484c08a33f522034c30d2b5
                           .group:00000000 wm4._stdint.h.10.c24fa3af3bc1706662bb5593a907e841
                           .group:00000000 wm4.stdint.h.23.d53047a68f4a85177f80b422d52785ed
                           .group:00000000 wm4.toolchain_defs.h.2.e5fd326231d01413e5361944b26cde07
                           .group:00000000 wm4.newlib.h.8.f6e543eac3f2f65163ba2ffe3b04987b
                           .group:00000000 wm4.ieeefp.h.77.220d9cccac42cd58761758bee2df4ce6
                           .group:00000000 wm4.config.h.220.6cac6a9685cfce5e83c17784171638d9
                           .group:00000000 wm4._ansi.h.31.de524f58584151836e90d8620a16f8e8
                           .group:00000000 wm4.stddef.h.39.a38874c8f8a57e66301090908ec2a69f
                           .group:00000000 wm4.lock.h.2.1461d1fff82dffe8bfddc23307f6484f
                           .group:00000000 wm4._types.h.125.5cf8a495f1f7ef36777ad868a1e32068
                           .group:00000000 wm4.stddef.h.161.5349cb105733e8777bfb0cf53c4e3f34
                           .group:00000000 wm4._types.h.184.03611d4f6b5bec9997bcf4279eceba07
                           .group:00000000 wm4.reent.h.17.90c2574d4acdcfce933db5cb09ff35fe
                           .group:00000000 wm4.cdefs.h.47.0bcdf94cb40e176393dd1404056825b4
                           .group:00000000 wm4.string.h.15.dab3980bf35408a4c507182805e2de3a
                           .group:00000000 wm4.stddef.h.161.19e15733342b50ead2919490b095303e
                           .group:00000000 wm4.stdbool.h.29.07dce69c3b78884144b7f7bd19483461
                           .group:00000000 wm4.hw_types.h.67.b10589a0806dcc2d274d6fab6b736519
                           .group:00000000 wm4.interrupt.h.41.272fc4ec0e276feb439e7974d0f77eaf
                           .group:00000000 wm4.board_info.h.22.34c159473b0affd9f1a6f5aa8cf576c9
                           .group:00000000 wm4.opendefs.h.23.3a22b672f37c862344b7aef3ebe35451
                           .group:00000000 wm4.stdio.h.27.3fc80220048df77954e38daec3bb9670
                           .group:00000000 wm4.stdarg.h.34.3a23a216c0c293b3d2ea2e89281481e6
                           .group:00000000 wm4.types.h.40.e8c16e7ec36ba55f133d0616070e25fc
                           .group:00000000 wm4._endian.h.31.65a10590763c3dde1ac4a7f66d7d4891
                           .group:00000000 wm4.endian.h.9.49f3a4695c1b61e8a0808de3c4a106cb
                           .group:00000000 wm4._timeval.h.30.0e8bfd94e85db17dda3286ee81496fe6
                           .group:00000000 wm4.timespec.h.41.d855182eb0e690443ab8651bcedca6e1
                           .group:00000000 wm4.select.h.19.97ca6fd0c752a0f3b6719fd314d361e6
                           .group:00000000 wm4.types.h.69.ed3eae3cf73030a737515151ebcab7a1
                           .group:00000000 wm4.sched.h.22.c60982713a5c428609783c78f9c78d95
                           .group:00000000 wm4._pthreadtypes.h.36.fcee9961c35163dde6267ef772ad1972
                           .group:00000000 wm4.stdio.h.2.4aa87247282eca6c8f36f9de33d8df1a
                           .group:00000000 wm4.stdio.h.81.932d0c162786b883f622b8d05c120c78
                           .group:00000000 wm4.stdarg.h.31.3fa7b8f6daaa31edd1696c08c77f2a73
                           .group:00000000 wm4.openserial.h.32.ea1006cc0a4d06130c082222e630581b
                           .group:00000000 wm4.opentimers.h.8.eb1cab84a6e82ba9569a1990291c92ba
                           .group:00000000 wm4.opencoap.h.32.4fd89a1f25836020968932a0f7dffe46
                           .group:00000000 wm4.cryptoengine.h.8.da068b9149b7576990bbc3b5f1e9b415
                           .group:00000000 wm4.sha.h.40.d735a7d478637a222f13b357edda1d20

UNDEFINED SYMBOLS
memcpy
opencoap_find_option
memset
packetfunctions_reserveHeaderSize
opencoap_options_encode
openserial_printError
cryptoengine_aes_ccms_enc
packetfunctions_tossHeader
cryptoengine_aes_ccms_dec
opencoap_options_parse
packetfunctions_tossFooter
packetfunctions_ntohs
cborencoder_put_array
cborencoder_put_bytes
cborencoder_put_unsigned
cborencoder_put_text
hkdf
packetfunctions_htons
